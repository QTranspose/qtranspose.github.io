<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Workflow Improvement With Simple Bash Scripts" /><meta name="author" content="QTranspose" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction As a pentester and a CTF player, we enjoy what we do, but at the same time, we try to avoid some hassles and repetitive tasks involved as much as possible. Although some of them are not avoidable (e.g. writing reports 😂), we can make our lives easier by doing things in some more elegant ways. In this article, I will share some small bash tricks that I use to make it a bit more elegant and to increase my productivity. Organise Workspaces 1 2 3 4 5 6 7 8 workspace() { ws=&quot;$HOME/$1&quot; if [ ! -d &quot;$ws&quot; ]; then mkdir &quot;$ws&quot; fi cd &quot;$ws&quot; tmux } I use the above bash function to create workspace directories before starting the actual work. It first checks if the directory with the specified name already exists, creates it if it does not, and cd to it. Then it starts a tmux session within that directory. The good thing in this is that every shell spawned in the tmux session will have an initial working directory being that directory. In this way, you can have your in-scope files well organised in the project workspace. Tmux Speaking of tmux, it is the terminal multiplexer that I use quite heavily. I won’t write about it becasue you can learn enough to begin using it from this video by IppSec: Log Terminal Sessions Sometimes you may find some key information missing in your notes when you try to turn them into a report after a pentest. This situation could be a disaster since you may need to do the exploit again. But it’s common because everyone may forget to write things down when they focus on their exploit during the engagement. Here comes why it’s important to log your terminal sessions. Recently I’m getting used to run script command to do that before I start exploitations. And I would recommend that you begin using it if you haven’t. Custom Nmap Commands nmap is a command that we run at the recon phase of almost every engagement. So you definitely don’t want to type the entire command with complicated arguments every time. So I have the following functions defined to facilitate myself a bit. nmap-default 1 2 3 4 5 6 nmap-default() { if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/default &quot;$1&quot; } nmap-default is a command I will run whenever I need to run a normal nmap tcp scan. It will enumerate service versions (-sV), run default NSE scripts (-sC), and output all formats (-oA). It runs with sudo to be able to use raw packets, assuring that its default behaviour is a syn scan (-sS) rather than a connect scan (-sT). Before running the scan, it will first check if a directory named recon already exists in the current working directory. It creates the directory if it does not exist, and this directory will be where all the output files located. This is just another small trick to keep things organised. nmap-full 1 2 3 4 5 6 7 8 9 10 11 12 13 nmap-full() { ports=$(sudo nmap -p- -T4 --min-rate=1000 &quot;$1&quot; | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//) if [ -z &quot;$ports&quot; ] then echo &quot;No ports open!&quot; else echo &quot;Open ports: $ports&quot; if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/full -p &quot;$ports&quot; &quot;$1&quot; fi } nmap-full is a two-phase full port (1-65535) tcp scan. Although it’s not used as often, it is still defined as a function in my shell resource files since it becomes handy when a full port scan is needed. In the first phase it will run a simpler full port scan, trading-off some accuracy for speed (--min-rate=1000 and -T4). Some people may prefer masscan in this phase. But I just find nmap itself can do the job with roughly the same level of speed and higher accuracy and stability. The purpose of the first phase is only to produce a list of open ports. In the second phase, another “heavier” nmap scan with similar options to nmap-default is performed only to this list of open ports. In this way, the scan can achieve both good performance and thoroughness. Conclusion These are some of the small tricks how I save myself from hassles and keep things organised. It’s really nothing fancy there. But the “hacky” way is sometimes just as simple. If you have some real m@g1c wanting to share with me, please find me at Github!" /><meta property="og:description" content="Introduction As a pentester and a CTF player, we enjoy what we do, but at the same time, we try to avoid some hassles and repetitive tasks involved as much as possible. Although some of them are not avoidable (e.g. writing reports 😂), we can make our lives easier by doing things in some more elegant ways. In this article, I will share some small bash tricks that I use to make it a bit more elegant and to increase my productivity. Organise Workspaces 1 2 3 4 5 6 7 8 workspace() { ws=&quot;$HOME/$1&quot; if [ ! -d &quot;$ws&quot; ]; then mkdir &quot;$ws&quot; fi cd &quot;$ws&quot; tmux } I use the above bash function to create workspace directories before starting the actual work. It first checks if the directory with the specified name already exists, creates it if it does not, and cd to it. Then it starts a tmux session within that directory. The good thing in this is that every shell spawned in the tmux session will have an initial working directory being that directory. In this way, you can have your in-scope files well organised in the project workspace. Tmux Speaking of tmux, it is the terminal multiplexer that I use quite heavily. I won’t write about it becasue you can learn enough to begin using it from this video by IppSec: Log Terminal Sessions Sometimes you may find some key information missing in your notes when you try to turn them into a report after a pentest. This situation could be a disaster since you may need to do the exploit again. But it’s common because everyone may forget to write things down when they focus on their exploit during the engagement. Here comes why it’s important to log your terminal sessions. Recently I’m getting used to run script command to do that before I start exploitations. And I would recommend that you begin using it if you haven’t. Custom Nmap Commands nmap is a command that we run at the recon phase of almost every engagement. So you definitely don’t want to type the entire command with complicated arguments every time. So I have the following functions defined to facilitate myself a bit. nmap-default 1 2 3 4 5 6 nmap-default() { if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/default &quot;$1&quot; } nmap-default is a command I will run whenever I need to run a normal nmap tcp scan. It will enumerate service versions (-sV), run default NSE scripts (-sC), and output all formats (-oA). It runs with sudo to be able to use raw packets, assuring that its default behaviour is a syn scan (-sS) rather than a connect scan (-sT). Before running the scan, it will first check if a directory named recon already exists in the current working directory. It creates the directory if it does not exist, and this directory will be where all the output files located. This is just another small trick to keep things organised. nmap-full 1 2 3 4 5 6 7 8 9 10 11 12 13 nmap-full() { ports=$(sudo nmap -p- -T4 --min-rate=1000 &quot;$1&quot; | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//) if [ -z &quot;$ports&quot; ] then echo &quot;No ports open!&quot; else echo &quot;Open ports: $ports&quot; if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/full -p &quot;$ports&quot; &quot;$1&quot; fi } nmap-full is a two-phase full port (1-65535) tcp scan. Although it’s not used as often, it is still defined as a function in my shell resource files since it becomes handy when a full port scan is needed. In the first phase it will run a simpler full port scan, trading-off some accuracy for speed (--min-rate=1000 and -T4). Some people may prefer masscan in this phase. But I just find nmap itself can do the job with roughly the same level of speed and higher accuracy and stability. The purpose of the first phase is only to produce a list of open ports. In the second phase, another “heavier” nmap scan with similar options to nmap-default is performed only to this list of open ports. In this way, the scan can achieve both good performance and thoroughness. Conclusion These are some of the small tricks how I save myself from hassles and keep things organised. It’s really nothing fancy there. But the “hacky” way is sometimes just as simple. If you have some real m@g1c wanting to share with me, please find me at Github!" /><link rel="canonical" href="https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/" /><meta property="og:url" content="https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/" /><meta property="og:site_name" content="QTranspose" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-05T00:00:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Workflow Improvement With Simple Bash Scripts" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@QTranspose" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Introduction As a pentester and a CTF player, we enjoy what we do, but at the same time, we try to avoid some hassles and repetitive tasks involved as much as possible. Although some of them are not avoidable (e.g. writing reports 😂), we can make our lives easier by doing things in some more elegant ways. In this article, I will share some small bash tricks that I use to make it a bit more elegant and to increase my productivity. Organise Workspaces 1 2 3 4 5 6 7 8 workspace() { ws=&quot;$HOME/$1&quot; if [ ! -d &quot;$ws&quot; ]; then mkdir &quot;$ws&quot; fi cd &quot;$ws&quot; tmux } I use the above bash function to create workspace directories before starting the actual work. It first checks if the directory with the specified name already exists, creates it if it does not, and cd to it. Then it starts a tmux session within that directory. The good thing in this is that every shell spawned in the tmux session will have an initial working directory being that directory. In this way, you can have your in-scope files well organised in the project workspace. Tmux Speaking of tmux, it is the terminal multiplexer that I use quite heavily. I won’t write about it becasue you can learn enough to begin using it from this video by IppSec: Log Terminal Sessions Sometimes you may find some key information missing in your notes when you try to turn them into a report after a pentest. This situation could be a disaster since you may need to do the exploit again. But it’s common because everyone may forget to write things down when they focus on their exploit during the engagement. Here comes why it’s important to log your terminal sessions. Recently I’m getting used to run script command to do that before I start exploitations. And I would recommend that you begin using it if you haven’t. Custom Nmap Commands nmap is a command that we run at the recon phase of almost every engagement. So you definitely don’t want to type the entire command with complicated arguments every time. So I have the following functions defined to facilitate myself a bit. nmap-default 1 2 3 4 5 6 nmap-default() { if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/default &quot;$1&quot; } nmap-default is a command I will run whenever I need to run a normal nmap tcp scan. It will enumerate service versions (-sV), run default NSE scripts (-sC), and output all formats (-oA). It runs with sudo to be able to use raw packets, assuring that its default behaviour is a syn scan (-sS) rather than a connect scan (-sT). Before running the scan, it will first check if a directory named recon already exists in the current working directory. It creates the directory if it does not exist, and this directory will be where all the output files located. This is just another small trick to keep things organised. nmap-full 1 2 3 4 5 6 7 8 9 10 11 12 13 nmap-full() { ports=$(sudo nmap -p- -T4 --min-rate=1000 &quot;$1&quot; | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\\n&#39; &#39;,&#39; | sed s/,$//) if [ -z &quot;$ports&quot; ] then echo &quot;No ports open!&quot; else echo &quot;Open ports: $ports&quot; if [ ! -d recon ]; then mkdir recon fi sudo nmap -sC -sV -oA recon/full -p &quot;$ports&quot; &quot;$1&quot; fi } nmap-full is a two-phase full port (1-65535) tcp scan. Although it’s not used as often, it is still defined as a function in my shell resource files since it becomes handy when a full port scan is needed. In the first phase it will run a simpler full port scan, trading-off some accuracy for speed (--min-rate=1000 and -T4). Some people may prefer masscan in this phase. But I just find nmap itself can do the job with roughly the same level of speed and higher accuracy and stability. The purpose of the first phase is only to produce a list of open ports. In the second phase, another “heavier” nmap scan with similar options to nmap-default is performed only to this list of open ports. In this way, the scan can achieve both good performance and thoroughness. Conclusion These are some of the small tricks how I save myself from hassles and keep things organised. It’s really nothing fancy there. But the “hacky” way is sometimes just as simple. If you have some real m@g1c wanting to share with me, please find me at Github!","@type":"BlogPosting","headline":"Workflow Improvement With Simple Bash Scripts","dateModified":"2021-02-25T13:11:20+11:00","datePublished":"2020-08-05T00:00:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/"},"author":{"@type":"Person","name":"QTranspose"},"url":"https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/","@context":"https://schema.org"}</script><title>Workflow Improvement With Simple Bash Scripts | QTranspose</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/qtranspose.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">QTranspose</a></div><div class="site-subtitle font-italic">Rock The Matrix</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/QTranspose" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/112476" aria-label="hackthebox" class="order-4" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Workflow Improvement With Simple Bash Scripts</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Workflow Improvement With Simple Bash Scripts</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 5, 2020, 12:00 AM +1000" > Aug 5, 2020 <i class="unloaded">2020-08-05T00:00:00+10:00</i> </span> by <span class="author"> QTranspose </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 25, 2021, 1:11 PM +1100" > Feb 25 <i class="unloaded">2021-02-25T13:11:20+11:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="765 words">4 min</span></div></div><div class="post-content"><h2 id="introduction">Introduction</h2><p>As a pentester and a CTF player, we enjoy what we do, but at the same time, we try to avoid some hassles and repetitive tasks involved as much as possible. Although some of them are not avoidable (e.g. writing reports 😂), we can make our lives easier by doing things in some more elegant ways. In this article, I will share some small bash tricks that I use to make it a bit more elegant and to increase my productivity.</p><h2 id="organise-workspaces">Organise Workspaces</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>workspace<span class="o">()</span> <span class="o">{</span>
    <span class="nv">ws</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/</span><span class="nv">$1</span><span class="s2">"</span>
    <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-d</span> <span class="s2">"</span><span class="nv">$ws</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">mkdir</span> <span class="s2">"</span><span class="nv">$ws</span><span class="s2">"</span>
    <span class="k">fi
    </span><span class="nb">cd</span> <span class="s2">"</span><span class="nv">$ws</span><span class="s2">"</span>
    tmux
<span class="o">}</span>
</pre></table></code></div></div><p>I use the above bash function to create workspace directories before starting the actual work. It first checks if the directory with the specified name already exists, creates it if it does not, and <code class="language-plaintext highlighter-rouge">cd</code> to it. Then it starts a <code class="language-plaintext highlighter-rouge">tmux</code> session within that directory. The good thing in this is that every shell spawned in the <code class="language-plaintext highlighter-rouge">tmux</code> session will have an initial working directory being that directory. In this way, you can have your in-scope files well organised in the project workspace.</p><h2 id="tmux">Tmux</h2><p>Speaking of <code class="language-plaintext highlighter-rouge">tmux</code>, it is the terminal multiplexer that I use quite heavily. I won’t write about it becasue you can learn enough to begin using it from this video by <a href="https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA">IppSec</a>:</p><div class="embed-responsive embed-responsive-16by9"> <iframe class="embed-responsive-item" width="560" height="315" src="https://www.youtube.com/embed/Lqehvpe_djs" frameborder="0" allowfullscreen=""> </iframe></div><h2 id="log-terminal-sessions">Log Terminal Sessions</h2><p>Sometimes you may find some key information missing in your notes when you try to turn them into a report after a pentest. This situation could be a disaster since you may need to do the exploit again. But it’s common because everyone may forget to write things down when they focus on their exploit during the engagement. Here comes why it’s important to log your terminal sessions. Recently I’m getting used to run <code class="language-plaintext highlighter-rouge">script</code> command to do that before I start exploitations. And I would recommend that you begin using it if you haven’t.</p><h2 id="custom-nmap-commands">Custom Nmap Commands</h2><p><code class="language-plaintext highlighter-rouge">nmap</code> is a command that we run at the recon phase of almost every engagement. So you definitely don’t want to type the entire command with complicated arguments every time. So I have the following functions defined to facilitate myself a bit.</p><h3 id="nmap-default">nmap-default</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>nmap-default<span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-d</span> recon <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">mkdir </span>recon
    <span class="k">fi
    </span><span class="nb">sudo </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oA</span> recon/default <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">nmap-default</code> is a command I will run whenever I need to run a normal <code class="language-plaintext highlighter-rouge">nmap</code> tcp scan. It will enumerate service versions (<code class="language-plaintext highlighter-rouge">-sV</code>), run default NSE scripts (<code class="language-plaintext highlighter-rouge">-sC</code>), and output all formats (<code class="language-plaintext highlighter-rouge">-oA</code>). It runs with <code class="language-plaintext highlighter-rouge">sudo</code> to be able to use raw packets, assuring that its default behaviour is a syn scan (<code class="language-plaintext highlighter-rouge">-sS</code>) rather than a connect scan (<code class="language-plaintext highlighter-rouge">-sT</code>).</p><p>Before running the scan, it will first check if a directory named <code class="language-plaintext highlighter-rouge">recon</code> already exists in the current working directory. It creates the directory if it does not exist, and this directory will be where all the output files located. This is just another small trick to keep things organised.</p><h3 id="nmap-full">nmap-full</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>nmap-full<span class="o">()</span> <span class="o">{</span>
    <span class="nv">ports</span><span class="o">=</span><span class="si">$(</span><span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> | <span class="nb">grep</span> ^[0-9] | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'/'</span> <span class="nt">-f</span> 1 | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">sed </span>s/,<span class="nv">$/</span>/<span class="si">)</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ports</span><span class="s2">"</span> <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"No ports open!"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Open ports: </span><span class="nv">$ports</span><span class="s2">"</span>
        <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-d</span> recon <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">mkdir </span>recon
        <span class="k">fi
        </span><span class="nb">sudo </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oA</span> recon/full <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$ports</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
    <span class="k">fi</span>
<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">nmap-full</code> is a two-phase full port (1-65535) tcp scan. Although it’s not used as often, it is still defined as a function in my shell resource files since it becomes handy when a full port scan is needed. In the first phase it will run a simpler full port scan, trading-off some accuracy for speed (<code class="language-plaintext highlighter-rouge">--min-rate=1000</code> and <code class="language-plaintext highlighter-rouge">-T4</code>). Some people may prefer <code class="language-plaintext highlighter-rouge">masscan</code> in this phase. But I just find <code class="language-plaintext highlighter-rouge">nmap</code> itself can do the job with roughly the same level of speed and higher accuracy and stability. The purpose of the first phase is only to produce a list of open ports. In the second phase, another “heavier” <code class="language-plaintext highlighter-rouge">nmap</code> scan with similar options to <code class="language-plaintext highlighter-rouge">nmap-default</code> is performed only to this list of open ports. In this way, the scan can achieve both good performance and thoroughness.</p><h2 id="conclusion">Conclusion</h2><p>These are some of the small tricks how I save myself from hassles and keep things organised. It’s really nothing fancy there. But the “hacky” way is sometimes just as simple. If you have some real m@g1c wanting to share with me, please find me at <a href="https://github.com/QTranspose">Github</a>!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux-daily-hassles/'>Linux Daily Hassles</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bash-scripting/" class="post-tag no-text-decoration" >Bash Scripting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Workflow Improvement With Simple Bash Scripts - QTranspose&url=https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Workflow Improvement With Simple Bash Scripts - QTranspose&u=https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Workflow Improvement With Simple Bash Scripts - QTranspose&url=https://qtranspose.xyz/posts/workflow-improvement-with-simple-bash-scripts/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-time/">HTB - Time</a><li><a href="/posts/htb-bankrobber/">HTB - Bankrobber</a><li><a href="/posts/htb-bounty/">HTB - Bounty</a><li><a href="/posts/htb-forest/">HTB - Forest</a><li><a href="/posts/htb-optimum/">HTB - Optimum</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/set-up-msf-in-arch-linux/"><div class="card-body"> <span class="timeago small" > May 8, 2019 <i class="unloaded">2019-05-08T00:00:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Set up MSF in Arch Linux</h3><div class="text-muted small"><p> This is the first time I use MSF on other systems than Kali. And currently there is some issue with msfdb scripts, so I’m gonna set it up manually. Let’s get started. $ sudo pacman -S postgresql me...</p></div></div></a></div><div class="card"> <a href="/posts/speed-up-arch-linux-aur-building/"><div class="card-body"> <span class="timeago small" > Jun 16, 2019 <i class="unloaded">2019-06-16T00:00:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Speed up Arch Linux AUR Building</h3><div class="text-muted small"><p> Edit /etc/makepkg.conf $ vim /etc/makepkg.conf Parallel compilation: MAKEFLAGS="-j$(nproc)" Parallel compression: COMPRESSXZ=(xz -c -z - --threads=0) # 0 for as many cores as possible COMPRESSG...</p></div></div></a></div><div class="card"> <a href="/posts/fix-video-tearing-in-gnome-with-intel-igpu/"><div class="card-body"> <span class="timeago small" > Aug 22, 2019 <i class="unloaded">2019-08-22T00:00:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fix Video Tearing in Gnome With Intel iGPU</h3><div class="text-muted small"><p> Edit /etc/X11/xorg.conf.d/20-intel.conf $ vim /etc/X11/xorg.conf.d/20-intel.conf Set the tear free option: Section "OutputClass" Identifier "Intel Graphics" MatchDriver "i915" Driver "intel...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/burp-suite-embedded-browser-initialization-failed/" class="btn btn-outline-primary" prompt="Older"><p>Burp Suite Embedded Browser Initialisation Failed</p></a> <a href="/posts/htb-legacy/" class="btn btn-outline-primary" prompt="Newer"><p>HTB - Legacy</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"></div><div class="footer-right"><p class="mb-0"> © 2021 <a href="https://github.com/QTranspose">QTranspose</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://qtranspose.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
